<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>HasManyThroughAssociationsTest</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            HasManyThroughAssociationsTest 
            
                <span class="parent">&lt; 
                    
                    ActiveRecord::TestCase
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/activerecord/test/cases/associations/has_many_through_associations_test_rb.html">activerecord/test/cases/associations/has_many_through_associations_test.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-make_model">make_model</a>,
              </li>
            
              
              <li>
                <a href="#method-i-make_no_pk_hm_t">make_no_pk_hm_t</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-name">name</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-setup">setup</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-test_add_two_instance_and_then_deleting">test_add_two_instance_and_then_deleting</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_assign_array_to_new_record_builds_join_records">test_assign_array_to_new_record_builds_join_records</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_existing">test_associate_existing</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_existing_record_twice_should_add_records_twice">test_associate_existing_record_twice_should_add_records_twice</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_existing_record_twice_should_add_to_target_twice">test_associate_existing_record_twice_should_add_to_target_twice</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_existing_with_nonstandard_primary_key_on_belongs_to">test_associate_existing_with_nonstandard_primary_key_on_belongs_to</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_new_by_building">test_associate_new_by_building</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create">test_associate_with_create</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create_and_invalid_options">test_associate_with_create_and_invalid_options</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create_and_no_options">test_associate_with_create_and_no_options</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create_and_valid_options">test_associate_with_create_and_valid_options</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create_bang_and_invalid_options">test_associate_with_create_bang_and_invalid_options</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create_bang_and_valid_options">test_associate_with_create_bang_and_valid_options</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create_exclamation_and_no_options">test_associate_with_create_exclamation_and_no_options</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associate_with_create_with_through_having_conditions">test_associate_with_create_with_through_having_conditions</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_associating_new">test_associating_new</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_association_callback_ordering">test_association_callback_ordering</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_association_proxy_transaction_method_starts_transaction_in_association_class">test_association_proxy_transaction_method_starts_transaction_in_association_class</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses">test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause">test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_belongs_to_with_dependent_delete_all">test_belongs_to_with_dependent_delete_all</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_belongs_to_with_dependent_destroy">test_belongs_to_with_dependent_destroy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_belongs_to_with_dependent_nullify">test_belongs_to_with_dependent_nullify</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_build_a_model_from_hm_through_association_with_where_clause">test_build_a_model_from_hm_through_association_with_where_clause</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_build_then_save_with_has_many_inverse">test_build_then_save_with_has_many_inverse</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_build_then_save_with_has_one_inverse">test_build_then_save_with_has_one_inverse</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_can_update_through_association">test_can_update_through_association</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_clear_associations">test_clear_associations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_build_with_nonstandard_primary_key_on_belongs_to">test_collection_build_with_nonstandard_primary_key_on_belongs_to</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_create_with_nonstandard_primary_key_on_belongs_to">test_collection_create_with_nonstandard_primary_key_on_belongs_to</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_delete_with_nonstandard_primary_key_on_belongs_to">test_collection_delete_with_nonstandard_primary_key_on_belongs_to</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_exists">test_collection_exists</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_singular_ids_getter_with_string_primary_keys">test_collection_singular_ids_getter_with_string_primary_keys</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_singular_ids_setter">test_collection_singular_ids_setter</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set">test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_collection_singular_ids_setter_with_string_primary_keys">test_collection_singular_ids_setter_with_string_primary_keys</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_concat">test_concat</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_count_has_many_through_with_named_scope">test_count_has_many_through_with_named_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_count_with_include_should_alias_join_table">test_count_with_include_should_alias_join_table</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_create_bang_returns_falsy_when_join_record_has_errors">test_create_bang_returns_falsy_when_join_record_has_errors</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_create_bang_should_raise_exception_when_join_record_has_errors">test_create_bang_should_raise_exception_when_join_record_has_errors</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_create_has_many_through_with_default_scope_on_join_model">test_create_has_many_through_with_default_scope_on_join_model</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_create_on_new_record">test_create_on_new_record</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_create_should_not_raise_exception_when_join_record_has_errors">test_create_should_not_raise_exception_when_join_record_has_errors</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_create_with_conditions_hash_on_through_association">test_create_with_conditions_hash_on_through_association</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_delete_all_for_with_dependent_option_delete_all">test_delete_all_for_with_dependent_option_delete_all</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_delete_all_for_with_dependent_option_destroy">test_delete_all_for_with_dependent_option_destroy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_delete_all_for_with_dependent_option_nullify">test_delete_all_for_with_dependent_option_nullify</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_delete_association">test_delete_association</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_delete_through_belongs_to_with_dependent_delete_all">test_delete_through_belongs_to_with_dependent_delete_all</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_delete_through_belongs_to_with_dependent_destroy">test_delete_through_belongs_to_with_dependent_destroy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_delete_through_belongs_to_with_dependent_nullify">test_delete_through_belongs_to_with_dependent_nullify</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter">test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_destroy_all">test_destroy_all</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_destroy_association">test_destroy_association</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_dynamic_find_should_respect_association_include">test_dynamic_find_should_respect_association_include</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_explicitly_joining_join_table">test_explicitly_joining_join_table</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_find_on_has_many_association_collection_with_include_and_conditions">test_find_on_has_many_association_collection_with_include_and_conditions</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include">test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_get_has_many_through_belongs_to_ids_with_conditions">test_get_has_many_through_belongs_to_ids_with_conditions</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_get_ids">test_get_ids</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_get_ids_for_has_many_through_with_conditions_should_not_preload">test_get_ids_for_has_many_through_with_conditions_should_not_preload</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_get_ids_for_loaded_associations">test_get_ids_for_loaded_associations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_get_ids_for_unloaded_associations_does_not_load_them">test_get_ids_for_unloaded_associations_does_not_load_them</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_association_through_a_belongs_to_association">test_has_many_association_through_a_belongs_to_association</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist">test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_association_through_a_has_many_association_to_self">test_has_many_association_through_a_has_many_association_to_self</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys">test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_add_with_sti_middle_relation">test_has_many_through_add_with_sti_middle_relation</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_associations_on_new_records_use_null_relations">test_has_many_through_associations_on_new_records_use_null_relations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes">test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_has_one_reflection">test_has_many_through_has_one_reflection</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_obeys_order_on_through_association">test_has_many_through_obeys_order_on_through_association</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_polymorphic_with_primary_key_option">test_has_many_through_polymorphic_with_primary_key_option</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_unscope_default_scope">test_has_many_through_unscope_default_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_with_default_scope_on_join_model">test_has_many_through_with_default_scope_on_join_model</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_with_default_scope_on_the_target">test_has_many_through_with_default_scope_on_the_target</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_with_includes_in_through_association_scope">test_has_many_through_with_includes_in_through_association_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_with_polymorphic_source">test_has_many_through_with_polymorphic_source</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_has_many_through_with_primary_key_option">test_has_many_through_with_primary_key_option</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_include-3F">test_include?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_build">test_include_method_in_association_through_should_return_true_for_instance_added_with_build</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds">test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_inner_join_with_quoted_table_name">test_inner_join_with_quoted_table_name</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_insert_records_via_has_many_through_association_with_scope">test_insert_records_via_has_many_through_association_with_scope</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_joining_has_many_through_belongs_to">test_joining_has_many_through_belongs_to</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_joining_has_many_through_with_uniq">test_joining_has_many_through_with_uniq</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_merge_join_association_with_has_many_through_association_proxy">test_merge_join_association_with_has_many_through_association_proxy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_modifying_has_many_through_has_one_reflection_should_raise">test_modifying_has_many_through_has_one_reflection_should_raise</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_no_pk_join_model_callbacks">test_no_pk_join_model_callbacks</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_no_pk_join_table_append">test_no_pk_join_table_append</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_no_pk_join_table_delete">test_no_pk_join_table_delete</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_ordered_habtm">test_ordered_habtm</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_pk_is_not_required_for_join">test_pk_is_not_required_for_join</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_preload_sti_middle_relation">test_preload_sti_middle_relation</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_preload_sti_rhs_class">test_preload_sti_rhs_class</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_preloading_empty_through_association_via_joins">test_preloading_empty_through_association_via_joins</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_primary_key_option_on_source">test_primary_key_option_on_source</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_push_with_invalid_join_record">test_push_with_invalid_join_record</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_push_with_invalid_record">test_push_with_invalid_record</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_replace_association">test_replace_association</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_replace_by_id_order_is_preserved">test_replace_by_id_order_is_preserved</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_replace_order_is_preserved">test_replace_order_is_preserved</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_save_bang_should_raise_exception_when_join_record_has_errors">test_save_bang_should_raise_exception_when_join_record_has_errors</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_save_should_not_raise_exception_when_join_record_has_errors">test_save_should_not_raise_exception_when_join_record_has_errors</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_select_chosen_fields_only">test_select_chosen_fields_only</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_should_raise_exception_for_destroying_mismatching_records">test_should_raise_exception_for_destroying_mismatching_records</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_singleton_has_many_through">test_singleton_has_many_through</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added">test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_through_association_readonly_should_be_false">test_through_association_readonly_should_be_false</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_update_counter_caches_on_delete">test_update_counter_caches_on_delete</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_update_counter_caches_on_delete_with_dependent_destroy">test_update_counter_caches_on_delete_with_dependent_destroy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_update_counter_caches_on_delete_with_dependent_nullify">test_update_counter_caches_on_delete_with_dependent_nullify</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_update_counter_caches_on_destroy">test_update_counter_caches_on_destroy</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_update_counter_caches_on_replace_association">test_update_counter_caches_on_replace_association</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-name">
            
              <b>name</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-c-name" name="method-c-name" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-name_source')" id="l_method-c-name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L66" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-c-name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 66</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">name</span>; <span class="ruby-string">&#39;Person&#39;</span>; <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-make_model">
            
              <b>make_model</b>(name)
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-make_model" name="method-i-make_model" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-make_model_source')" id="l_method-i-make_model_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L60" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-make_model_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">make_model</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>) { <span class="ruby-identifier">define_singleton_method</span>(<span class="ruby-value">:name</span>) { <span class="ruby-identifier">name</span> } }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-make_no_pk_hm_t">
            
              <b>make_no_pk_hm_t</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-make_no_pk_hm_t" name="method-i-make_no_pk_hm_t" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-make_no_pk_hm_t_source')" id="l_method-i-make_no_pk_hm_t_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L148" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-make_no_pk_hm_t_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">make_no_pk_hm_t</span>
  <span class="ruby-identifier">lesson</span> = <span class="ruby-identifier">make_model</span> <span class="ruby-string">&#39;Lesson&#39;</span>
  <span class="ruby-identifier">student</span> = <span class="ruby-identifier">make_model</span> <span class="ruby-string">&#39;Student&#39;</span>

  <span class="ruby-identifier">lesson_student</span> = <span class="ruby-identifier">make_model</span> <span class="ruby-string">&#39;LessonStudent&#39;</span>
  <span class="ruby-identifier">lesson_student</span>.<span class="ruby-identifier">table_name</span> = <span class="ruby-string">&#39;lessons_students&#39;</span>

  <span class="ruby-identifier">lesson_student</span>.<span class="ruby-identifier">belongs_to</span> <span class="ruby-value">:lesson</span>, <span class="ruby-value">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lesson</span>
  <span class="ruby-identifier">lesson_student</span>.<span class="ruby-identifier">belongs_to</span> <span class="ruby-value">:student</span>, <span class="ruby-value">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">student</span>
  <span class="ruby-identifier">lesson</span>.<span class="ruby-identifier">has_many</span> <span class="ruby-value">:lesson_students</span>, <span class="ruby-value">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lesson_student</span>
  <span class="ruby-identifier">lesson</span>.<span class="ruby-identifier">has_many</span> <span class="ruby-value">:students</span>, <span class="ruby-value">:through</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:lesson_students</span>, <span class="ruby-value">:class</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">student</span>
  [<span class="ruby-identifier">lesson</span>, <span class="ruby-identifier">lesson_student</span>, <span class="ruby-identifier">student</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-setup">
            
              <b>setup</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-setup" name="method-i-setup" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Dummies to force column loads so query counts are clean.</p>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-setup_source')" id="l_method-i-setup_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L35" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-setup_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 35</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">setup</span>
  <span class="ruby-constant">Person</span>.<span class="ruby-identifier">create</span> <span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;gummy&#39;</span>
  <span class="ruby-constant">Reader</span>.<span class="ruby-identifier">create</span> <span class="ruby-value">:person_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>, <span class="ruby-value">:post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_add_two_instance_and_then_deleting">
            
              <b>test_add_two_instance_and_then_deleting</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_add_two_instance_and_then_deleting" name="method-i-test_add_two_instance_and_then_deleting" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_add_two_instance_and_then_deleting_source')" id="l_method-i-test_add_two_instance_and_then_deleting_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L253" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_add_two_instance_and_then_deleting_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 253</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_add_two_instance_and_then_deleting</span>
  <span class="ruby-identifier">post</span>   = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">person</span>
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">person</span>

  <span class="ruby-identifier">counts</span> = [<span class="ruby-string">&#39;post.people.count&#39;</span>, <span class="ruby-string">&#39;post.people.to_a.count&#39;</span>, <span class="ruby-string">&#39;post.readers.count&#39;</span>, <span class="ruby-string">&#39;post.readers.to_a.count&#39;</span>]
  <span class="ruby-identifier">assert_difference</span> <span class="ruby-identifier">counts</span>, <span class="ruby-number">-2</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">person</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">person</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_assign_array_to_new_record_builds_join_records">
            
              <b>test_assign_array_to_new_record_builds_join_records</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_assign_array_to_new_record_builds_join_records" name="method-i-test_assign_array_to_new_record_builds_join_records" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_assign_array_to_new_record_builds_join_records_source')" id="l_method-i-test_assign_array_to_new_record_builds_join_records_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1030" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_assign_array_to_new_record_builds_join_records_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1030</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_assign_array_to_new_record_builds_join_records</span>
  <span class="ruby-identifier">c</span> = <span class="ruby-constant">Category</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Fishing&#39;</span>, <span class="ruby-value">:authors</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">Author</span>.<span class="ruby-identifier">first</span>])
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">c</span>.<span class="ruby-identifier">categorizations</span>.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_existing">
            
              <b>test_associate_existing</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_existing" name="method-i-test_associate_existing" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_existing_source')" id="l_method-i-test_associate_existing_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L177" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_existing_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 177</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_existing</span>
  <span class="ruby-identifier">post</span>   = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">person</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">person</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">person</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_existing_record_twice_should_add_records_twice">
            
              <b>test_associate_existing_record_twice_should_add_records_twice</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_existing_record_twice_should_add_records_twice" name="method-i-test_associate_existing_record_twice_should_add_records_twice" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_existing_record_twice_should_add_records_twice_source')" id="l_method-i-test_associate_existing_record_twice_should_add_records_twice_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L243" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_existing_record_twice_should_add_records_twice_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_existing_record_twice_should_add_records_twice</span>
  <span class="ruby-identifier">post</span>   = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)

  <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;post.people.count&#39;</span>, <span class="ruby-number">2</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">person</span>
    <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">person</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_existing_record_twice_should_add_to_target_twice">
            
              <b>test_associate_existing_record_twice_should_add_to_target_twice</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_existing_record_twice_should_add_to_target_twice" name="method-i-test_associate_existing_record_twice_should_add_to_target_twice" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_existing_record_twice_should_add_to_target_twice_source')" id="l_method-i-test_associate_existing_record_twice_should_add_to_target_twice_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L233" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_existing_record_twice_should_add_to_target_twice_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 233</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_existing_record_twice_should_add_to_target_twice</span>
  <span class="ruby-identifier">post</span>   = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)

  <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;post.people.to_a.count&#39;</span>, <span class="ruby-number">2</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">person</span>
    <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">person</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_existing_with_nonstandard_primary_key_on_belongs_to">
            
              <b>test_associate_existing_with_nonstandard_primary_key_on_belongs_to</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_existing_with_nonstandard_primary_key_on_belongs_to" name="method-i-test_associate_existing_with_nonstandard_primary_key_on_belongs_to" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_existing_with_nonstandard_primary_key_on_belongs_to_source')" id="l_method-i-test_associate_existing_with_nonstandard_primary_key_on_belongs_to_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L800" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_existing_with_nonstandard_primary_key_on_belongs_to_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 800</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_existing_with_nonstandard_primary_key_on_belongs_to</span>
  <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>), <span class="ruby-value">:named_category_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>).<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>), <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>).<span class="ruby-identifier">named_categories</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_new_by_building">
            
              <b>test_associate_new_by_building</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_new_by_building" name="method-i-test_associate_new_by_building" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_new_by_building_source')" id="l_method-i-test_associate_new_by_building_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L289" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_new_by_building_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 289</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_new_by_building</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) { <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>) }

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">0</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Bob&quot;</span>)
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Ted&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Should only need to load the association once</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first_name</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;Bob&quot;</span>)
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first_name</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;Ted&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># 2 queries for each new record (1 to save the record itself, 1 for the join model)</span>
  <span class="ruby-comment">#    * 2 new records = 4</span>
  <span class="ruby-comment"># + 1 query to save the actual post = 5</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">5</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">body</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&#39;-changed&#39;</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">save</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first_name</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;Bob&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first_name</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;Ted&quot;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create">
            
              <b>test_associate_with_create</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create" name="method-i-test_associate_with_create" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_source')" id="l_method-i-test_associate_with_create_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L566" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 566</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) { <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>) }

  <span class="ruby-comment"># 1 query for the new record, 1 for the join table record</span>
  <span class="ruby-comment"># No need to update the actual collection yet!</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">2</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:first_name=</span><span class="ruby-operator">&gt;</span><span class="ruby-string">&quot;Jeb&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># *Now* we actually need the collection so it&#39;s loaded</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first_name</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;Jeb&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first_name</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;Jeb&quot;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create_and_invalid_options">
            
              <b>test_associate_with_create_and_invalid_options</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create_and_invalid_options" name="method-i-test_associate_with_create_and_invalid_options" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_and_invalid_options_source')" id="l_method-i-test_associate_with_create_and_invalid_options_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L608" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_and_invalid_options_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 608</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create_and_invalid_options</span>
  <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:first_firm</span>)
  <span class="ruby-identifier">assert_no_difference</span>(<span class="ruby-string">&#39;firm.developers.count&#39;</span>) { <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">developers</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;0&#39;</span>) } }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create_and_no_options">
            
              <b>test_associate_with_create_and_no_options</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create_and_no_options" name="method-i-test_associate_with_create_and_no_options" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_and_no_options_source')" id="l_method-i-test_associate_with_create_and_no_options_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L583" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_and_no_options_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 583</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create_and_no_options</span>
  <span class="ruby-identifier">peeps</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;foo&#39;</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">peeps</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create_and_valid_options">
            
              <b>test_associate_with_create_and_valid_options</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create_and_valid_options" name="method-i-test_associate_with_create_and_valid_options" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_and_valid_options_source')" id="l_method-i-test_associate_with_create_and_valid_options_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L613" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_and_valid_options_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 613</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create_and_valid_options</span>
  <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:first_firm</span>)
  <span class="ruby-identifier">assert_difference</span>(<span class="ruby-string">&#39;firm.developers.count&#39;</span>, <span class="ruby-number">1</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">developers</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;developer&#39;</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create_bang_and_invalid_options">
            
              <b>test_associate_with_create_bang_and_invalid_options</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create_bang_and_invalid_options" name="method-i-test_associate_with_create_bang_and_invalid_options" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_bang_and_invalid_options_source')" id="l_method-i-test_associate_with_create_bang_and_invalid_options_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L618" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_bang_and_invalid_options_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 618</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create_bang_and_invalid_options</span>
  <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:first_firm</span>)
  <span class="ruby-identifier">assert_no_difference</span>(<span class="ruby-string">&#39;firm.developers.count&#39;</span>) { <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">developers</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;0&#39;</span>) } }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create_bang_and_valid_options">
            
              <b>test_associate_with_create_bang_and_valid_options</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create_bang_and_valid_options" name="method-i-test_associate_with_create_bang_and_valid_options" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_bang_and_valid_options_source')" id="l_method-i-test_associate_with_create_bang_and_valid_options_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L623" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_bang_and_valid_options_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 623</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create_bang_and_valid_options</span>
  <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:first_firm</span>)
  <span class="ruby-identifier">assert_difference</span>(<span class="ruby-string">&#39;firm.developers.count&#39;</span>, <span class="ruby-number">1</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">developers</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;developer&#39;</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create_exclamation_and_no_options">
            
              <b>test_associate_with_create_exclamation_and_no_options</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create_exclamation_and_no_options" name="method-i-test_associate_with_create_exclamation_and_no_options" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_exclamation_and_no_options_source')" id="l_method-i-test_associate_with_create_exclamation_and_no_options_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L595" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_exclamation_and_no_options_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 595</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create_exclamation_and_no_options</span>
  <span class="ruby-identifier">peeps</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;foo&#39;</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">peeps</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associate_with_create_with_through_having_conditions">
            
              <b>test_associate_with_create_with_through_having_conditions</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associate_with_create_with_through_having_conditions" name="method-i-test_associate_with_create_with_through_having_conditions" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associate_with_create_with_through_having_conditions_source')" id="l_method-i-test_associate_with_create_with_through_having_conditions_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L589" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associate_with_create_with_through_having_conditions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 589</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associate_with_create_with_through_having_conditions</span>
  <span class="ruby-identifier">impatient_people</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">impatient_people</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">impatient_people</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;foo&#39;</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">impatient_people</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">impatient_people</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_associating_new">
            
              <b>test_associating_new</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_associating_new" name="method-i-test_associating_new" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_associating_new_source')" id="l_method-i-test_associating_new_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L268" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_associating_new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 268</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_associating_new</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) { <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>) }
  <span class="ruby-identifier">new_person</span> = <span class="ruby-keyword">nil</span> <span class="ruby-comment"># so block binding catches it</span>

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">0</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">new_person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span> <span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;bob&#39;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Associating new records always saves them</span>
  <span class="ruby-comment"># Thus, 1 query for the new person record, 1 query for the new join table record</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">2</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_person</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">new_person</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">new_person</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_association_callback_ordering">
            
              <b>test_association_callback_ordering</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_association_callback_ordering" name="method-i-test_association_callback_ordering" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_association_callback_ordering_source')" id="l_method-i-test_association_callback_ordering_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L660" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_association_callback_ordering_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 660</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_association_callback_ordering</span>
  <span class="ruby-constant">Post</span>.<span class="ruby-identifier">reset_log</span>
  <span class="ruby-identifier">log</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">log</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people_with_callbacks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">assert_equal</span> [
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;Michael&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;Michael&quot;</span>]
  ], <span class="ruby-identifier">log</span>.<span class="ruby-identifier">last</span>(<span class="ruby-number">2</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people_with_callbacks</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>), <span class="ruby-constant">Person</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Bob&quot;</span>), <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Lary&quot;</span>))
  <span class="ruby-identifier">assert_equal</span> [
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;David&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;David&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;Bob&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;Bob&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;Lary&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;Lary&quot;</span>]
  ],<span class="ruby-identifier">log</span>.<span class="ruby-identifier">last</span>(<span class="ruby-number">6</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people_with_callbacks</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Ted&quot;</span>)
  <span class="ruby-identifier">assert_equal</span> [
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;Ted&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;Ted&quot;</span>]
  ], <span class="ruby-identifier">log</span>.<span class="ruby-identifier">last</span>(<span class="ruby-number">2</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people_with_callbacks</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Sam&quot;</span>)
  <span class="ruby-identifier">assert_equal</span> [
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;Sam&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;Sam&quot;</span>]
  ], <span class="ruby-identifier">log</span>.<span class="ruby-identifier">last</span>(<span class="ruby-number">2</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people_with_callbacks</span> = [<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>),<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>), <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Julian&quot;</span>), <span class="ruby-constant">Person</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Roger&quot;</span>)]
  <span class="ruby-identifier">assert_equal</span>((<span class="ruby-node">%w(Ted Bob Sam Lary)</span> <span class="ruby-operator">*</span> <span class="ruby-number">2</span>).<span class="ruby-identifier">sort</span>, <span class="ruby-identifier">log</span>[<span class="ruby-number">-12</span><span class="ruby-operator">..</span><span class="ruby-number">-5</span>].<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:last</span>).<span class="ruby-identifier">sort</span>)
  <span class="ruby-identifier">assert_equal</span> [
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;Julian&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;Julian&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:before</span>, <span class="ruby-string">&quot;Roger&quot;</span>],
    [<span class="ruby-value">:added</span>, <span class="ruby-value">:after</span>, <span class="ruby-string">&quot;Roger&quot;</span>]
  ], <span class="ruby-identifier">log</span>.<span class="ruby-identifier">last</span>(<span class="ruby-number">4</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people_with_callbacks</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">assert_equal</span>((<span class="ruby-node">%w(Michael David Julian Roger)</span> <span class="ruby-operator">*</span> <span class="ruby-number">2</span>).<span class="ruby-identifier">sort</span>, <span class="ruby-identifier">log</span>.<span class="ruby-identifier">last</span>(<span class="ruby-number">8</span>).<span class="ruby-identifier">collect</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:last</span>).<span class="ruby-identifier">sort</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_association_proxy_transaction_method_starts_transaction_in_association_class">
            
              <b>test_association_proxy_transaction_method_starts_transaction_in_association_class</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_association_proxy_transaction_method_starts_transaction_in_association_class" name="method-i-test_association_proxy_transaction_method_starts_transaction_in_association_class" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_association_proxy_transaction_method_starts_transaction_in_association_class_source')" id="l_method-i-test_association_proxy_transaction_method_starts_transaction_in_association_class_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L746" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_association_proxy_transaction_method_starts_transaction_in_association_class_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 746</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_association_proxy_transaction_method_starts_transaction_in_association_class</span>
  <span class="ruby-constant">Tag</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-value">:transaction</span>)
  <span class="ruby-constant">Post</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># nothing</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses">
            
              <b>test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses" name="method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses_source')" id="l_method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L876" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 876</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_attributes_are_being_set_when_initialized_from_hm_through_association_with_multiple_where_clauses</span>
  <span class="ruby-identifier">new_subscriber</span> = <span class="ruby-identifier">books</span>(<span class="ruby-value">:awdr</span>).<span class="ruby-identifier">subscribers</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:nick</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;marklazz&quot;</span>).<span class="ruby-identifier">where</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Marcelo Giorgi&#39;</span>).<span class="ruby-identifier">build</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_subscriber</span>.<span class="ruby-identifier">nick</span>, <span class="ruby-string">&quot;marklazz&quot;</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_subscriber</span>.<span class="ruby-identifier">name</span>, <span class="ruby-string">&quot;Marcelo Giorgi&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause">
            
              <b>test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause" name="method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause_source')" id="l_method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L871" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 871</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_attributes_are_being_set_when_initialized_from_hm_through_association_with_where_clause</span>
  <span class="ruby-identifier">new_subscriber</span> = <span class="ruby-identifier">books</span>(<span class="ruby-value">:awdr</span>).<span class="ruby-identifier">subscribers</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:nick</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;marklazz&quot;</span>).<span class="ruby-identifier">build</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">new_subscriber</span>.<span class="ruby-identifier">nick</span>, <span class="ruby-string">&quot;marklazz&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_belongs_to_with_dependent_delete_all">
            
              <b>test_belongs_to_with_dependent_delete_all</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_belongs_to_with_dependent_delete_all" name="method-i-test_belongs_to_with_dependent_delete_all" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_belongs_to_with_dependent_delete_all_source')" id="l_method-i-test_belongs_to_with_dependent_delete_all_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L448" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_belongs_to_with_dependent_delete_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 448</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_belongs_to_with_dependent_delete_all</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">PersonWithDependentDeleteAllJobs</span>.<span class="ruby-identifier">find</span>(<span class="ruby-number">1</span>)

  <span class="ruby-comment"># Create a reference which is not linked to a job. This should not be destroyed.</span>
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">references</span>.<span class="ruby-identifier">create!</span>

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Job.count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;Reference.count&#39;</span>, <span class="ruby-operator">-</span><span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs</span>.<span class="ruby-identifier">count</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">destroy</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_belongs_to_with_dependent_destroy">
            
              <b>test_belongs_to_with_dependent_destroy</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_belongs_to_with_dependent_destroy" name="method-i-test_belongs_to_with_dependent_destroy" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_belongs_to_with_dependent_destroy_source')" id="l_method-i-test_belongs_to_with_dependent_destroy_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L435" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_belongs_to_with_dependent_destroy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 435</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_belongs_to_with_dependent_destroy</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">PersonWithDependentDestroyJobs</span>.<span class="ruby-identifier">find</span>(<span class="ruby-number">1</span>)

  <span class="ruby-comment"># Create a reference which is not linked to a job. This should not be destroyed.</span>
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">references</span>.<span class="ruby-identifier">create!</span>

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Job.count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;Reference.count&#39;</span>, <span class="ruby-operator">-</span><span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs</span>.<span class="ruby-identifier">count</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">destroy</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_belongs_to_with_dependent_nullify">
            
              <b>test_belongs_to_with_dependent_nullify</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_belongs_to_with_dependent_nullify" name="method-i-test_belongs_to_with_dependent_nullify" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_belongs_to_with_dependent_nullify_source')" id="l_method-i-test_belongs_to_with_dependent_nullify_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L461" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_belongs_to_with_dependent_nullify_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 461</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_belongs_to_with_dependent_nullify</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">PersonWithDependentNullifyJobs</span>.<span class="ruby-identifier">find</span>(<span class="ruby-number">1</span>)

  <span class="ruby-identifier">references</span> = <span class="ruby-identifier">person</span>.<span class="ruby-identifier">references</span>.<span class="ruby-identifier">to_a</span>

  <span class="ruby-identifier">assert_no_difference</span> [<span class="ruby-string">&#39;Reference.count&#39;</span>, <span class="ruby-string">&#39;Job.count&#39;</span>] <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">person</span>.<span class="ruby-identifier">destroy</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">references</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">reference</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">reference</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">job_id</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_build_a_model_from_hm_through_association_with_where_clause">
            
              <b>test_build_a_model_from_hm_through_association_with_where_clause</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_build_a_model_from_hm_through_association_with_where_clause" name="method-i-test_build_a_model_from_hm_through_association_with_where_clause" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_build_a_model_from_hm_through_association_with_where_clause_source')" id="l_method-i-test_build_a_model_from_hm_through_association_with_where_clause_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L867" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_build_a_model_from_hm_through_association_with_where_clause_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 867</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_build_a_model_from_hm_through_association_with_where_clause</span>
  <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">books</span>(<span class="ruby-value">:awdr</span>).<span class="ruby-identifier">subscribers</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:nick</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;marklazz&quot;</span>).<span class="ruby-identifier">build</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_build_then_save_with_has_many_inverse">
            
              <b>test_build_then_save_with_has_many_inverse</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_build_then_save_with_has_many_inverse" name="method-i-test_build_then_save_with_has_many_inverse" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_build_then_save_with_has_many_inverse_source')" id="l_method-i-test_build_then_save_with_has_many_inverse_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L315" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_build_then_save_with_has_many_inverse_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 315</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_build_then_save_with_has_many_inverse</span>
  <span class="ruby-identifier">post</span>   = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Bob&quot;</span>)
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">person</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_build_then_save_with_has_one_inverse">
            
              <b>test_build_then_save_with_has_one_inverse</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_build_then_save_with_has_one_inverse" name="method-i-test_build_then_save_with_has_one_inverse" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_build_then_save_with_has_one_inverse_source')" id="l_method-i-test_build_then_save_with_has_one_inverse_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L324" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_build_then_save_with_has_one_inverse_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 324</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_build_then_save_with_has_one_inverse</span>
  <span class="ruby-identifier">post</span>   = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">single_people</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Bob&quot;</span>)
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">single_people</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">person</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_can_update_through_association">
            
              <b>test_can_update_through_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_can_update_through_association" name="method-i-test_can_update_through_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_can_update_through_association_source')" id="l_method-i-test_can_update_through_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L901" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_can_update_through_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 901</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_can_update_through_association</span>
  <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">update!</span>(<span class="ruby-identifier">title</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Can write&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_clear_associations">
            
              <b>test_clear_associations</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_clear_associations" name="method-i-test_clear_associations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_clear_associations_source')" id="l_method-i-test_clear_associations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L646" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_clear_associations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 646</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_clear_associations</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">2</span>) { <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>);<span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>) }

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">0</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_build_with_nonstandard_primary_key_on_belongs_to">
            
              <b>test_collection_build_with_nonstandard_primary_key_on_belongs_to</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_build_with_nonstandard_primary_key_on_belongs_to" name="method-i-test_collection_build_with_nonstandard_primary_key_on_belongs_to" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_build_with_nonstandard_primary_key_on_belongs_to_source')" id="l_method-i-test_collection_build_with_nonstandard_primary_key_on_belongs_to_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L805" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_build_with_nonstandard_primary_key_on_belongs_to_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 805</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_build_with_nonstandard_primary_key_on_belongs_to</span>
  <span class="ruby-identifier">author</span>   = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>)
  <span class="ruby-identifier">category</span> = <span class="ruby-identifier">author</span>.<span class="ruby-identifier">named_categories</span>.<span class="ruby-identifier">build</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Primary&quot;</span>)
  <span class="ruby-identifier">author</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-value">:author_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:named_category_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">named_categories</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">category</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_create_with_nonstandard_primary_key_on_belongs_to">
            
              <b>test_collection_create_with_nonstandard_primary_key_on_belongs_to</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_create_with_nonstandard_primary_key_on_belongs_to" name="method-i-test_collection_create_with_nonstandard_primary_key_on_belongs_to" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_create_with_nonstandard_primary_key_on_belongs_to_source')" id="l_method-i-test_collection_create_with_nonstandard_primary_key_on_belongs_to_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L813" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_create_with_nonstandard_primary_key_on_belongs_to_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 813</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_create_with_nonstandard_primary_key_on_belongs_to</span>
  <span class="ruby-identifier">author</span>   = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>)
  <span class="ruby-identifier">category</span> = <span class="ruby-identifier">author</span>.<span class="ruby-identifier">named_categories</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Primary&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-value">:author_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:named_category_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">named_categories</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">category</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_delete_with_nonstandard_primary_key_on_belongs_to">
            
              <b>test_collection_delete_with_nonstandard_primary_key_on_belongs_to</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_delete_with_nonstandard_primary_key_on_belongs_to" name="method-i-test_collection_delete_with_nonstandard_primary_key_on_belongs_to" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_delete_with_nonstandard_primary_key_on_belongs_to_source')" id="l_method-i-test_collection_delete_with_nonstandard_primary_key_on_belongs_to_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L827" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_delete_with_nonstandard_primary_key_on_belongs_to_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 827</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_delete_with_nonstandard_primary_key_on_belongs_to</span>
  <span class="ruby-identifier">author</span>   = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>)
  <span class="ruby-identifier">category</span> = <span class="ruby-identifier">author</span>.<span class="ruby-identifier">named_categories</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Primary&quot;</span>)
  <span class="ruby-identifier">author</span>.<span class="ruby-identifier">named_categories</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">category</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-value">:author_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:named_category_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">named_categories</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_exists">
            
              <b>test_collection_exists</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_exists" name="method-i-test_collection_exists" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_exists_source')" id="l_method-i-test_collection_exists_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L820" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_exists_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 820</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_exists</span>
  <span class="ruby-identifier">author</span>   = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>)
  <span class="ruby-identifier">category</span> = <span class="ruby-constant">Category</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">author_ids</span><span class="ruby-operator">:</span> [<span class="ruby-identifier">author</span>.<span class="ruby-identifier">id</span>], <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;Primary&quot;</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">authors</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">id</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">authors</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">id</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_singular_ids_getter_with_string_primary_keys">
            
              <b>test_collection_singular_ids_getter_with_string_primary_keys</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_singular_ids_getter_with_string_primary_keys" name="method-i-test_collection_singular_ids_getter_with_string_primary_keys" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_singular_ids_getter_with_string_primary_keys_source')" id="l_method-i-test_collection_singular_ids_getter_with_string_primary_keys_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L835" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_singular_ids_getter_with_string_primary_keys_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 835</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_singular_ids_getter_with_string_primary_keys</span>
  <span class="ruby-identifier">book</span> = <span class="ruby-identifier">books</span>(<span class="ruby-value">:awdr</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">book</span>.<span class="ruby-identifier">subscriber_ids</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">subscribers</span>(<span class="ruby-value">:first</span>).<span class="ruby-identifier">nick</span>, <span class="ruby-identifier">subscribers</span>(<span class="ruby-value">:second</span>).<span class="ruby-identifier">nick</span>].<span class="ruby-identifier">sort</span>, <span class="ruby-identifier">book</span>.<span class="ruby-identifier">subscriber_ids</span>.<span class="ruby-identifier">sort</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_singular_ids_setter">
            
              <b>test_collection_singular_ids_setter</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_singular_ids_setter" name="method-i-test_collection_singular_ids_setter" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_singular_ids_setter_source')" id="l_method-i-test_collection_singular_ids_setter_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L841" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_singular_ids_setter_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 841</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_singular_ids_setter</span>
  <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:rails_core</span>)
  <span class="ruby-identifier">dev</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">first</span>

  <span class="ruby-identifier">company</span>.<span class="ruby-identifier">developer_ids</span> = [<span class="ruby-identifier">dev</span>.<span class="ruby-identifier">id</span>]
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">dev</span>], <span class="ruby-identifier">company</span>.<span class="ruby-identifier">developers</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set">
            
              <b>test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set" name="method-i-test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set_source')" id="l_method-i-test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L861" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 861</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_singular_ids_setter_raises_exception_when_invalid_ids_set</span>
  <span class="ruby-identifier">company</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:rails_core</span>)
  <span class="ruby-identifier">ids</span> =  [<span class="ruby-constant">Developer</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">id</span>, <span class="ruby-number">-9999</span>]
  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>) {<span class="ruby-identifier">company</span>.<span class="ruby-identifier">developer_ids</span>= <span class="ruby-identifier">ids</span>}
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_collection_singular_ids_setter_with_string_primary_keys">
            
              <b>test_collection_singular_ids_setter_with_string_primary_keys</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_collection_singular_ids_setter_with_string_primary_keys" name="method-i-test_collection_singular_ids_setter_with_string_primary_keys" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_collection_singular_ids_setter_with_string_primary_keys_source')" id="l_method-i-test_collection_singular_ids_setter_with_string_primary_keys_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L849" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_collection_singular_ids_setter_with_string_primary_keys_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 849</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_collection_singular_ids_setter_with_string_primary_keys</span>
  <span class="ruby-identifier">assert_nothing_raised</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">book</span> = <span class="ruby-identifier">books</span>(<span class="ruby-value">:awdr</span>)
    <span class="ruby-identifier">book</span>.<span class="ruby-identifier">subscriber_ids</span> = [<span class="ruby-identifier">subscribers</span>(<span class="ruby-value">:second</span>).<span class="ruby-identifier">nick</span>]
    <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">subscribers</span>(<span class="ruby-value">:second</span>)], <span class="ruby-identifier">book</span>.<span class="ruby-identifier">subscribers</span>(<span class="ruby-keyword">true</span>)

    <span class="ruby-identifier">book</span>.<span class="ruby-identifier">subscriber_ids</span> = []
    <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">book</span>.<span class="ruby-identifier">subscribers</span>(<span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">end</span>

<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_concat">
            
              <b>test_concat</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_concat" name="method-i-test_concat" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_concat_source')" id="l_method-i-test_concat_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L225" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_concat_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 225</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_concat</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)
  <span class="ruby-identifier">post</span>   = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">concat</span> [<span class="ruby-identifier">person</span>]
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_count_has_many_through_with_named_scope">
            
              <b>test_count_has_many_through_with_named_scope</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_count_has_many_through_with_named_scope" name="method-i-test_count_has_many_through_with_named_scope" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_count_has_many_through_with_named_scope_source')" id="l_method-i-test_count_has_many_through_with_named_scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L969" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_count_has_many_through_with_named_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 969</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_count_has_many_through_with_named_scope</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>).<span class="ruby-identifier">categories</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>).<span class="ruby-identifier">categories</span>.<span class="ruby-identifier">general</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_count_with_include_should_alias_join_table">
            
              <b>test_count_with_include_should_alias_join_table</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_count_with_include_should_alias_join_table" name="method-i-test_count_with_include_should_alias_join_table" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_count_with_include_should_alias_join_table_source')" id="l_method-i-test_count_with_include_should_alias_join_table_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L712" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_count_with_include_should_alias_join_table_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 712</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_count_with_include_should_alias_join_table</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">includes</span>(<span class="ruby-value">:readers</span>).<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_create_bang_returns_falsy_when_join_record_has_errors">
            
              <b>test_create_bang_returns_falsy_when_join_record_has_errors</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_create_bang_returns_falsy_when_join_record_has_errors" name="method-i-test_create_bang_returns_falsy_when_join_record_has_errors" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_create_bang_returns_falsy_when_join_record_has_errors_source')" id="l_method-i-test_create_bang_returns_falsy_when_join_record_has_errors_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1054" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_create_bang_returns_falsy_when_join_record_has_errors_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1054</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_create_bang_returns_falsy_when_join_record_has_errors</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Categorization</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:base</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;Invalid Categorization&#39;</span> }
    <span class="ruby-identifier">c</span> = <span class="ruby-constant">Category</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Fishing&#39;</span>, <span class="ruby-value">:authors</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">Author</span>.<span class="ruby-identifier">first</span>])
    <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">c</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_create_bang_should_raise_exception_when_join_record_has_errors">
            
              <b>test_create_bang_should_raise_exception_when_join_record_has_errors</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_create_bang_should_raise_exception_when_join_record_has_errors" name="method-i-test_create_bang_should_raise_exception_when_join_record_has_errors" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_create_bang_should_raise_exception_when_join_record_has_errors_source')" id="l_method-i-test_create_bang_should_raise_exception_when_join_record_has_errors_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1035" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_create_bang_should_raise_exception_when_join_record_has_errors_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1035</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_create_bang_should_raise_exception_when_join_record_has_errors</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Categorization</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:base</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;Invalid Categorization&#39;</span> }
    <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-constant">Category</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Fishing&#39;</span>, <span class="ruby-value">:authors</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">Author</span>.<span class="ruby-identifier">first</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_create_has_many_through_with_default_scope_on_join_model">
            
              <b>test_create_has_many_through_with_default_scope_on_join_model</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_create_has_many_through_with_default_scope_on_join_model" name="method-i-test_create_has_many_through_with_default_scope_on_join_model" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_create_has_many_through_with_default_scope_on_join_model_source')" id="l_method-i-test_create_has_many_through_with_default_scope_on_join_model_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L937" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_create_has_many_through_with_default_scope_on_join_model_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 937</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_create_has_many_through_with_default_scope_on_join_model</span>
  <span class="ruby-identifier">category</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">special_categories</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Foo&quot;</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">category</span>.<span class="ruby-identifier">categorizations</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:special</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>).<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_create_on_new_record">
            
              <b>test_create_on_new_record</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_create_on_new_record" name="method-i-test_create_on_new_record" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_create_on_new_record_source')" id="l_method-i-test_create_on_new_record_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L601" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_create_on_new_record_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 601</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_create_on_new_record</span>
  <span class="ruby-identifier">p</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotSaved</span>) { <span class="ruby-identifier">p</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;mew&quot;</span>) }
  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotSaved</span>) { <span class="ruby-identifier">p</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;snow&quot;</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_create_should_not_raise_exception_when_join_record_has_errors">
            
              <b>test_create_should_not_raise_exception_when_join_record_has_errors</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_create_should_not_raise_exception_when_join_record_has_errors" name="method-i-test_create_should_not_raise_exception_when_join_record_has_errors" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_create_should_not_raise_exception_when_join_record_has_errors_source')" id="l_method-i-test_create_should_not_raise_exception_when_join_record_has_errors_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1015" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_create_should_not_raise_exception_when_join_record_has_errors_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1015</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_create_should_not_raise_exception_when_join_record_has_errors</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Categorization</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:base</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;Invalid Categorization&#39;</span> }
    <span class="ruby-constant">Category</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Fishing&#39;</span>, <span class="ruby-value">:authors</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">Author</span>.<span class="ruby-identifier">first</span>])
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_create_with_conditions_hash_on_through_association">
            
              <b>test_create_with_conditions_hash_on_through_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_create_with_conditions_hash_on_through_association" name="method-i-test_create_with_conditions_hash_on_through_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_create_with_conditions_hash_on_through_association_source')" id="l_method-i-test_create_with_conditions_hash_on_through_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L989" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_create_with_conditions_hash_on_through_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 989</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_create_with_conditions_hash_on_through_association</span>
  <span class="ruby-identifier">member</span> = <span class="ruby-identifier">members</span>(<span class="ruby-value">:groucho</span>)
  <span class="ruby-identifier">club</span>   = <span class="ruby-identifier">member</span>.<span class="ruby-identifier">clubs</span>.<span class="ruby-identifier">create!</span>

  <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">club</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">membership</span>.<span class="ruby-identifier">favourite</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_delete_all_for_with_dependent_option_delete_all">
            
              <b>test_delete_all_for_with_dependent_option_delete_all</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_delete_all_for_with_dependent_option_delete_all" name="method-i-test_delete_all_for_with_dependent_option_delete_all" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_delete_all_for_with_dependent_option_delete_all_source')" id="l_method-i-test_delete_all_for_with_dependent_option_delete_all_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L214" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_delete_all_for_with_dependent_option_delete_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 214</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_delete_all_for_with_dependent_option_delete_all</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs_with_dependent_delete_all</span>.<span class="ruby-identifier">count</span>

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Job.count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;Reference.count&#39;</span>, <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">jobs_with_dependent_delete_all</span>.<span class="ruby-identifier">delete_all</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_delete_all_for_with_dependent_option_destroy">
            
              <b>test_delete_all_for_with_dependent_option_destroy</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_delete_all_for_with_dependent_option_destroy" name="method-i-test_delete_all_for_with_dependent_option_destroy" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_delete_all_for_with_dependent_option_destroy_source')" id="l_method-i-test_delete_all_for_with_dependent_option_destroy_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L192" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_delete_all_for_with_dependent_option_destroy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 192</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_delete_all_for_with_dependent_option_destroy</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs_with_dependent_destroy</span>.<span class="ruby-identifier">count</span>

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Job.count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;Reference.count&#39;</span>, <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">jobs_with_dependent_destroy</span>.<span class="ruby-identifier">delete_all</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_delete_all_for_with_dependent_option_nullify">
            
              <b>test_delete_all_for_with_dependent_option_nullify</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_delete_all_for_with_dependent_option_nullify" name="method-i-test_delete_all_for_with_dependent_option_nullify" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_delete_all_for_with_dependent_option_nullify_source')" id="l_method-i-test_delete_all_for_with_dependent_option_nullify_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L203" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_delete_all_for_with_dependent_option_nullify_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 203</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_delete_all_for_with_dependent_option_nullify</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs_with_dependent_nullify</span>.<span class="ruby-identifier">count</span>

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Job.count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Reference.count&#39;</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">jobs_with_dependent_nullify</span>.<span class="ruby-identifier">delete_all</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_delete_association">
            
              <b>test_delete_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_delete_association" name="method-i-test_delete_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_delete_association_source')" id="l_method-i-test_delete_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L333" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_delete_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 333</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_delete_association</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">2</span>){<span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>);<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>); }

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">1</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_delete_through_belongs_to_with_dependent_delete_all">
            
              <b>test_delete_through_belongs_to_with_dependent_delete_all</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_delete_through_belongs_to_with_dependent_delete_all" name="method-i-test_delete_through_belongs_to_with_dependent_delete_all" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_delete_through_belongs_to_with_dependent_delete_all_source')" id="l_method-i-test_delete_through_belongs_to_with_dependent_delete_all_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L393" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_delete_through_belongs_to_with_dependent_delete_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 393</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_delete_through_belongs_to_with_dependent_delete_all</span>
  <span class="ruby-constant">Reference</span>.<span class="ruby-identifier">make_comments</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">job</span>    = <span class="ruby-identifier">jobs</span>(<span class="ruby-value">:magician</span>)

  <span class="ruby-comment"># Make sure we&#39;re not deleting everything</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-number">2</span>

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Job.count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> [<span class="ruby-string">&#39;person.jobs.count&#39;</span>, <span class="ruby-string">&#39;Reference.count&#39;</span>], <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs_with_dependent_delete_all</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">job</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Check that the destroy callback on Reference did not run</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">comments</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-constant">Reference</span>.<span class="ruby-identifier">make_comments</span> = <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_delete_through_belongs_to_with_dependent_destroy">
            
              <b>test_delete_through_belongs_to_with_dependent_destroy</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_delete_through_belongs_to_with_dependent_destroy" name="method-i-test_delete_through_belongs_to_with_dependent_destroy" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_delete_through_belongs_to_with_dependent_destroy_source')" id="l_method-i-test_delete_through_belongs_to_with_dependent_destroy_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L414" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_delete_through_belongs_to_with_dependent_destroy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 414</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_delete_through_belongs_to_with_dependent_destroy</span>
  <span class="ruby-constant">Reference</span>.<span class="ruby-identifier">make_comments</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">job</span>    = <span class="ruby-identifier">jobs</span>(<span class="ruby-value">:magician</span>)

  <span class="ruby-comment"># Make sure we&#39;re not deleting everything</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-number">2</span>

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;Job.count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> [<span class="ruby-string">&#39;person.jobs.count&#39;</span>, <span class="ruby-string">&#39;Reference.count&#39;</span>], <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs_with_dependent_destroy</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">job</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Check that the destroy callback on Reference ran</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-string">&quot;Reference destroyed&quot;</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">comments</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-constant">Reference</span>.<span class="ruby-identifier">make_comments</span> = <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_delete_through_belongs_to_with_dependent_nullify">
            
              <b>test_delete_through_belongs_to_with_dependent_nullify</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_delete_through_belongs_to_with_dependent_nullify" name="method-i-test_delete_through_belongs_to_with_dependent_nullify" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_delete_through_belongs_to_with_dependent_nullify_source')" id="l_method-i-test_delete_through_belongs_to_with_dependent_nullify_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L375" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_delete_through_belongs_to_with_dependent_nullify_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 375</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_delete_through_belongs_to_with_dependent_nullify</span>
  <span class="ruby-constant">Reference</span>.<span class="ruby-identifier">make_comments</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-identifier">person</span>    = <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">job</span>       = <span class="ruby-identifier">jobs</span>(<span class="ruby-value">:magician</span>)
  <span class="ruby-identifier">reference</span> = <span class="ruby-constant">Reference</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:job_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">job</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:person_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">first</span>

  <span class="ruby-identifier">assert_no_difference</span> [<span class="ruby-string">&#39;Job.count&#39;</span>, <span class="ruby-string">&#39;Reference.count&#39;</span>] <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;person.jobs.count&#39;</span>, <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs_with_dependent_nullify</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">job</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert_equal</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">reference</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">job_id</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-constant">Reference</span>.<span class="ruby-identifier">make_comments</span> = <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter">
            
              <b>test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter" name="method-i-test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter_source')" id="l_method-i-test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L996" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 996</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_deleting_from_has_many_through_a_belongs_to_should_not_try_to_update_counter</span>
  <span class="ruby-identifier">post</span>    = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>)
  <span class="ruby-identifier">address</span> = <span class="ruby-identifier">author_addresses</span>(<span class="ruby-value">:david_address</span>)

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_addresses</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">address</span>)
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_addresses</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">address</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">post</span>[<span class="ruby-value">:author_count</span>].<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_destroy_all">
            
              <b>test_destroy_all</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_destroy_all" name="method-i-test_destroy_all" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_destroy_all_source')" id="l_method-i-test_destroy_all_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L358" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_destroy_all_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 358</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_destroy_all</span>
  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&quot;Person.count&quot;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&quot;Reader.count&quot;</span>, <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">destroy_all</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_destroy_association">
            
              <b>test_destroy_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_destroy_association" name="method-i-test_destroy_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_destroy_association_source')" id="l_method-i-test_destroy_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L347" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_destroy_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 347</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_destroy_association</span>
  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&quot;Person.count&quot;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&quot;Reader.count&quot;</span>, <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>))
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_dynamic_find_should_respect_association_include">
            
              <b>test_dynamic_find_should_respect_association_include</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_dynamic_find_should_respect_association_include" name="method-i-test_dynamic_find_should_respect_association_include" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_dynamic_find_should_respect_association_include_source')" id="l_method-i-test_dynamic_find_should_respect_association_include_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L706" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_dynamic_find_should_respect_association_include_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 706</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_dynamic_find_should_respect_association_include</span>
  <span class="ruby-comment"># SQL error in sort clause if :include is not included</span>
  <span class="ruby-comment"># due to Unknown column &#39;comments.id&#39;</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-constant">Person</span>.<span class="ruby-identifier">find</span>(<span class="ruby-number">1</span>).<span class="ruby-identifier">posts_with_comments_sorted_by_comment_id</span>.<span class="ruby-identifier">find_by_title</span>(<span class="ruby-string">&#39;Welcome to the weblog&#39;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_explicitly_joining_join_table">
            
              <b>test_explicitly_joining_join_table</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_explicitly_joining_join_table" name="method-i-test_explicitly_joining_join_table" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_explicitly_joining_join_table_source')" id="l_method-i-test_explicitly_joining_join_table_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1070" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_explicitly_joining_join_table_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1070</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_explicitly_joining_join_table</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">owners</span>(<span class="ruby-value">:blackbeard</span>).<span class="ruby-identifier">toys</span>, <span class="ruby-identifier">owners</span>(<span class="ruby-value">:blackbeard</span>).<span class="ruby-identifier">toys</span>.<span class="ruby-identifier">with_pet</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_find_on_has_many_association_collection_with_include_and_conditions">
            
              <b>test_find_on_has_many_association_collection_with_include_and_conditions</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_find_on_has_many_association_collection_with_include_and_conditions" name="method-i-test_find_on_has_many_association_collection_with_include_and_conditions" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_find_on_has_many_association_collection_with_include_and_conditions_source')" id="l_method-i-test_find_on_has_many_association_collection_with_include_and_conditions_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L776" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_find_on_has_many_association_collection_with_include_and_conditions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 776</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_find_on_has_many_association_collection_with_include_and_conditions</span>
  <span class="ruby-identifier">post_with_no_comments</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">posts_with_no_comments</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">post_with_no_comments</span>, <span class="ruby-identifier">posts</span>(<span class="ruby-value">:authorless</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include">
            
              <b>test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include" name="method-i-test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include_source')" id="l_method-i-test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L964" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 964</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_get_collection_singular_ids_on_has_many_through_with_conditions_and_include</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts_with_no_comment_ids</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts_with_no_comments</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_get_has_many_through_belongs_to_ids_with_conditions">
            
              <b>test_get_has_many_through_belongs_to_ids_with_conditions</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_get_has_many_through_belongs_to_ids_with_conditions" name="method-i-test_get_has_many_through_belongs_to_ids_with_conditions" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_get_has_many_through_belongs_to_ids_with_conditions_source')" id="l_method-i-test_get_has_many_through_belongs_to_ids_with_conditions_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L960" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_get_has_many_through_belongs_to_ids_with_conditions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 960</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_get_has_many_through_belongs_to_ids_with_conditions</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>).<span class="ruby-identifier">categories_like_general_ids</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_get_ids">
            
              <b>test_get_ids</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_get_ids" name="method-i-test_get_ids" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_get_ids_source')" id="l_method-i-test_get_ids_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L720" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_get_ids_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 720</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_get_ids</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">posts</span>(<span class="ruby-value">:authorless</span>).<span class="ruby-identifier">id</span>].<span class="ruby-identifier">sort</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">post_ids</span>.<span class="ruby-identifier">sort</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_get_ids_for_has_many_through_with_conditions_should_not_preload">
            
              <b>test_get_ids_for_has_many_through_with_conditions_should_not_preload</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_get_ids_for_has_many_through_with_conditions_should_not_preload" name="method-i-test_get_ids_for_has_many_through_with_conditions_should_not_preload" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_get_ids_for_has_many_through_with_conditions_should_not_preload_source')" id="l_method-i-test_get_ids_for_has_many_through_with_conditions_should_not_preload_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L724" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_get_ids_for_has_many_through_with_conditions_should_not_preload_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 724</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_get_ids_for_has_many_through_with_conditions_should_not_preload</span>
  <span class="ruby-constant">Tagging</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:taggable_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Post&#39;</span>, <span class="ruby-value">:taggable_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">id</span>, <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tags</span>(<span class="ruby-value">:misc</span>))
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Associations</span><span class="ruby-operator">::</span><span class="ruby-constant">Preloader</span>.<span class="ruby-identifier">expects</span>(<span class="ruby-value">:new</span>).<span class="ruby-identifier">never</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">misc_tag_ids</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_get_ids_for_loaded_associations">
            
              <b>test_get_ids_for_loaded_associations</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_get_ids_for_loaded_associations" name="method-i-test_get_ids_for_loaded_associations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_get_ids_for_loaded_associations_source')" id="l_method-i-test_get_ids_for_loaded_associations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L730" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_get_ids_for_loaded_associations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 730</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_get_ids_for_loaded_associations</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>(<span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">0</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">person</span>.<span class="ruby-identifier">post_ids</span>
    <span class="ruby-identifier">person</span>.<span class="ruby-identifier">post_ids</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_get_ids_for_unloaded_associations_does_not_load_them">
            
              <b>test_get_ids_for_unloaded_associations_does_not_load_them</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_get_ids_for_unloaded_associations_does_not_load_them" name="method-i-test_get_ids_for_unloaded_associations_does_not_load_them" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_get_ids_for_unloaded_associations_does_not_load_them_source')" id="l_method-i-test_get_ids_for_unloaded_associations_does_not_load_them_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L739" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_get_ids_for_unloaded_associations_does_not_load_them_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 739</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_get_ids_for_unloaded_associations_does_not_load_them</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">loaded?</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">posts</span>(<span class="ruby-value">:authorless</span>).<span class="ruby-identifier">id</span>].<span class="ruby-identifier">sort</span>, <span class="ruby-identifier">person</span>.<span class="ruby-identifier">post_ids</span>.<span class="ruby-identifier">sort</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">loaded?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_association_through_a_belongs_to_association">
            
              <b>test_has_many_association_through_a_belongs_to_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_association_through_a_belongs_to_association" name="method-i-test_has_many_association_through_a_belongs_to_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_association_through_a_belongs_to_association_source')" id="l_method-i-test_has_many_association_through_a_belongs_to_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L758" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_association_through_a_belongs_to_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 758</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_association_through_a_belongs_to_association</span>
  <span class="ruby-identifier">author</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>)
  <span class="ruby-identifier">post</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">author</span>, <span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;TITLE&quot;</span>, <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;BODY&quot;</span>)
  <span class="ruby-identifier">author</span>.<span class="ruby-identifier">author_favorites</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:favorite_author_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">author</span>.<span class="ruby-identifier">author_favorites</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:favorite_author_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">2</span>)
  <span class="ruby-identifier">author</span>.<span class="ruby-identifier">author_favorites</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:favorite_author_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">3</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author</span>.<span class="ruby-identifier">author_favorites</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_favorites</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist">
            
              <b>test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist" name="method-i-test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist_source')" id="l_method-i-test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L753" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 753</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_association_through_a_belongs_to_association_where_the_association_doesnt_exist</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;TITLE&quot;</span>, <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;BODY&quot;</span>)
  <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_favorites</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_association_through_a_has_many_association_to_self">
            
              <b>test_has_many_association_through_a_has_many_association_to_self</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_association_through_a_has_many_association_to_self" name="method-i-test_has_many_association_through_a_has_many_association_to_self" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_association_through_a_has_many_association_to_self_source')" id="l_method-i-test_has_many_association_through_a_has_many_association_to_self_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L793" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_association_through_a_has_many_association_to_self_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 793</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_association_through_a_has_many_association_to_self</span>
  <span class="ruby-identifier">sarah</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Sarah&#39;</span>, <span class="ruby-value">:primary_contact_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">people</span>(<span class="ruby-value">:susan</span>).<span class="ruby-identifier">id</span>, <span class="ruby-value">:gender</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;F&#39;</span>, <span class="ruby-value">:number1_fan_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">john</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;John&#39;</span>, <span class="ruby-value">:primary_contact_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">sarah</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:gender</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;M&#39;</span>, <span class="ruby-value">:number1_fan_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">sarah</span>.<span class="ruby-identifier">agents</span>, [<span class="ruby-identifier">john</span>]
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">people</span>(<span class="ruby-value">:susan</span>).<span class="ruby-identifier">agents</span>.<span class="ruby-identifier">flat_map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:agents</span>), <span class="ruby-identifier">people</span>(<span class="ruby-value">:susan</span>).<span class="ruby-identifier">agents_of_agents</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys">
            
              <b>test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys" name="method-i-test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys_source')" id="l_method-i-test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L772" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 772</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_association_through_a_has_many_association_with_nonstandard_primary_keys</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">owners</span>(<span class="ruby-value">:blackbeard</span>).<span class="ruby-identifier">toys</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_add_with_sti_middle_relation">
            
              <b>test_has_many_through_add_with_sti_middle_relation</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_add_with_sti_middle_relation" name="method-i-test_has_many_through_add_with_sti_middle_relation" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_add_with_sti_middle_relation_source')" id="l_method-i-test_has_many_through_add_with_sti_middle_relation_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1133" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_add_with_sti_middle_relation_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1133</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_add_with_sti_middle_relation</span>
  <span class="ruby-identifier">club</span> = <span class="ruby-constant">SuperClub</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Fight Club&#39;</span>)
  <span class="ruby-identifier">member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Tyler Durden&#39;</span>)

  <span class="ruby-identifier">club</span>.<span class="ruby-identifier">members</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">member</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-constant">SuperMembership</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">member_id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">member</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">club_id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">club</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_associations_on_new_records_use_null_relations">
            
              <b>test_has_many_through_associations_on_new_records_use_null_relations</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_associations_on_new_records_use_null_relations" name="method-i-test_has_many_through_associations_on_new_records_use_null_relations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_associations_on_new_records_use_null_relations_source')" id="l_method-i-test_has_many_through_associations_on_new_records_use_null_relations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1085" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_associations_on_new_records_use_null_relations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1085</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_associations_on_new_records_use_null_relations</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">assert_no_queries</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>
    <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">body</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;omg&#39;</span>)
    <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">pluck</span>(<span class="ruby-value">:body</span>)
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">0</span>,  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">sum</span>(<span class="ruby-value">:tags_count</span>)
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">0</span>,  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">count</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes">
            
              <b>test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes" name="method-i-test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes_source')" id="l_method-i-test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L974" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 974</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_belongs_to_should_update_when_the_through_foreign_key_changes</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:eager_other</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_categorizations</span>
  <span class="ruby-identifier">proxy</span> = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:association_instance_get</span>, <span class="ruby-value">:author_categorizations</span>)

  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">proxy</span>.<span class="ruby-identifier">stale_target?</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>).<span class="ruby-identifier">categorizations</span>.<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>), <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_categorizations</span>.<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>)

  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_id</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">id</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">proxy</span>.<span class="ruby-identifier">stale_target?</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">categorizations</span>.<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>), <span class="ruby-identifier">post</span>.<span class="ruby-identifier">author_categorizations</span>.<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_has_one_reflection">
            
              <b>test_has_many_through_has_one_reflection</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_has_one_reflection" name="method-i-test_has_many_through_has_one_reflection" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_has_one_reflection_source')" id="l_method-i-test_has_many_through_has_one_reflection_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L781" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_has_one_reflection_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 781</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_has_one_reflection</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">comments</span>(<span class="ruby-value">:eager_sti_on_associations_vs_comment</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">very_special_comments</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_obeys_order_on_through_association">
            
              <b>test_has_many_through_obeys_order_on_through_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_obeys_order_on_through_association" name="method-i-test_has_many_through_obeys_order_on_through_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_obeys_order_on_through_association_source')" id="l_method-i-test_has_many_through_obeys_order_on_through_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1079" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_obeys_order_on_through_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1079</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_obeys_order_on_through_association</span>
  <span class="ruby-identifier">owner</span> = <span class="ruby-identifier">owners</span>(<span class="ruby-value">:blackbeard</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">owner</span>.<span class="ruby-identifier">toys</span>.<span class="ruby-identifier">to_sql</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;pets.name desc&quot;</span>)
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&quot;parrot&quot;</span>, <span class="ruby-string">&quot;bulbul&quot;</span>], <span class="ruby-identifier">owner</span>.<span class="ruby-identifier">toys</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">pet</span>.<span class="ruby-identifier">name</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_polymorphic_with_primary_key_option">
            
              <b>test_has_many_through_polymorphic_with_primary_key_option</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_polymorphic_with_primary_key_option" name="method-i-test_has_many_through_polymorphic_with_primary_key_option" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_polymorphic_with_primary_key_option_source')" id="l_method-i-test_has_many_through_polymorphic_with_primary_key_option_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L907" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_polymorphic_with_primary_key_option_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 907</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_polymorphic_with_primary_key_option</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">essay_categories</span>

  <span class="ruby-identifier">authors</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">joins</span>(<span class="ruby-value">:essay_categories</span>).<span class="ruby-identifier">where</span>(<span class="ruby-string">&#39;categories.id&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>).<span class="ruby-identifier">id</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>), <span class="ruby-identifier">authors</span>.<span class="ruby-identifier">first</span>

  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">owners</span>(<span class="ruby-value">:blackbeard</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">essay_owners</span>

  <span class="ruby-identifier">authors</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">joins</span>(<span class="ruby-value">:essay_owners</span>).<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;owners.name = &#39;blackbeard&#39;&quot;</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>), <span class="ruby-identifier">authors</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_unscope_default_scope">
            
              <b>test_has_many_through_unscope_default_scope</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_unscope_default_scope" name="method-i-test_has_many_through_unscope_default_scope" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_unscope_default_scope_source')" id="l_method-i-test_has_many_through_unscope_default_scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1121" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_unscope_default_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1121</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_unscope_default_scope</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Beaches&#39;</span>, <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;I like beaches!&quot;</span>)
  <span class="ruby-constant">Reader</span>.<span class="ruby-identifier">create!</span> <span class="ruby-value">:person</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>), <span class="ruby-value">:post</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">post</span>
  <span class="ruby-constant">LazyReader</span>.<span class="ruby-identifier">create!</span> <span class="ruby-value">:person</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">people</span>(<span class="ruby-value">:susan</span>), <span class="ruby-value">:post</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">post</span>

  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">lazy_people</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">size</span>

  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">lazy_readers_unscope_skimmers</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">lazy_people_unscope_skimmers</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_with_default_scope_on_join_model">
            
              <b>test_has_many_through_with_default_scope_on_join_model</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_with_default_scope_on_join_model" name="method-i-test_has_many_through_with_default_scope_on_join_model" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_with_default_scope_on_join_model_source')" id="l_method-i-test_has_many_through_with_default_scope_on_join_model_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L933" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_with_default_scope_on_join_model_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 933</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_with_default_scope_on_join_model</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">order</span>(<span class="ruby-string">&#39;id&#39;</span>).<span class="ruby-identifier">to_a</span>, <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">comments_on_first_posts</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_with_default_scope_on_the_target">
            
              <b>test_has_many_through_with_default_scope_on_the_target</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_with_default_scope_on_the_target" name="method-i-test_has_many_through_with_default_scope_on_the_target" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_with_default_scope_on_the_target_source')" id="l_method-i-test_has_many_through_with_default_scope_on_the_target_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1097" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_with_default_scope_on_the_target_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1097</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_with_default_scope_on_the_target</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)], <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_posts</span>

  <span class="ruby-identifier">readers</span>(<span class="ruby-value">:michael_authorless</span>).<span class="ruby-identifier">update</span>(<span class="ruby-identifier">first_post_id</span><span class="ruby-operator">:</span> <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)], <span class="ruby-identifier">person</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">first_posts</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_with_includes_in_through_association_scope">
            
              <b>test_has_many_through_with_includes_in_through_association_scope</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_with_includes_in_through_association_scope" name="method-i-test_has_many_through_with_includes_in_through_association_scope" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_with_includes_in_through_association_scope_source')" id="l_method-i-test_has_many_through_with_includes_in_through_association_scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1105" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_with_includes_in_through_association_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1105</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_with_includes_in_through_association_scope</span>
  <span class="ruby-identifier">assert_not_empty</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">author_address_extra_with_address</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_with_polymorphic_source">
            
              <b>test_has_many_through_with_polymorphic_source</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_with_polymorphic_source" name="method-i-test_has_many_through_with_polymorphic_source" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_with_polymorphic_source_source')" id="l_method-i-test_has_many_through_with_polymorphic_source_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1074" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_with_polymorphic_source_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1074</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_with_polymorphic_source</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">tags</span>(<span class="ruby-value">:general</span>).<span class="ruby-identifier">tagged_posts</span>.<span class="ruby-identifier">create!</span> <span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;foo&quot;</span>, <span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;bar&quot;</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">tags</span>(<span class="ruby-value">:general</span>)], <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">tags</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_has_many_through_with_primary_key_option">
            
              <b>test_has_many_through_with_primary_key_option</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_has_many_through_with_primary_key_option" name="method-i-test_has_many_through_with_primary_key_option" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_has_many_through_with_primary_key_option_source')" id="l_method-i-test_has_many_through_with_primary_key_option_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L919" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_has_many_through_with_primary_key_option_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 919</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_has_many_through_with_primary_key_option</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>)], <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">essay_categories_2</span>

  <span class="ruby-identifier">authors</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">joins</span>(<span class="ruby-value">:essay_categories_2</span>).<span class="ruby-identifier">where</span>(<span class="ruby-string">&#39;categories.id&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>).<span class="ruby-identifier">id</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>), <span class="ruby-identifier">authors</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_include-3F">
            
              <b>test_include?</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_include-3F" name="method-i-test_include-3F" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_include-3F_source')" id="l_method-i-test_include-3F_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L170" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_include-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 170</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_include?</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">post</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">post</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_build">
            
              <b>test_include_method_in_association_through_should_return_true_for_instance_added_with_build</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_build" name="method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_build" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_build_source')" id="l_method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_build_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L882" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_build_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 882</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_include_method_in_association_through_should_return_true_for_instance_added_with_build</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">reference</span> = <span class="ruby-identifier">person</span>.<span class="ruby-identifier">references</span>.<span class="ruby-identifier">build</span>
  <span class="ruby-identifier">job</span> = <span class="ruby-identifier">reference</span>.<span class="ruby-identifier">build_job</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">jobs</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">job</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds">
            
              <b>test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds" name="method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds_source')" id="l_method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L889" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 889</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_include_method_in_association_through_should_return_true_for_instance_added_with_nested_builds</span>
  <span class="ruby-identifier">author</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">author</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">build</span>
  <span class="ruby-identifier">comment</span> = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">build</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">author</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">comment</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_inner_join_with_quoted_table_name">
            
              <b>test_inner_join_with_quoted_table_name</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_inner_join_with_quoted_table_name" name="method-i-test_inner_join_with_quoted_table_name" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_inner_join_with_quoted_table_name_source')" id="l_method-i-test_inner_join_with_quoted_table_name_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L716" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_inner_join_with_quoted_table_name_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 716</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_inner_join_with_quoted_table_name</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">jobs</span>.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_insert_records_via_has_many_through_association_with_scope">
            
              <b>test_insert_records_via_has_many_through_association_with_scope</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_insert_records_via_has_many_through_association_with_scope" name="method-i-test_insert_records_via_has_many_through_association_with_scope" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_insert_records_via_has_many_through_association_with_scope_source')" id="l_method-i-test_insert_records_via_has_many_through_association_with_scope_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1109" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_insert_records_via_has_many_through_association_with_scope_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1109</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_insert_records_via_has_many_through_association_with_scope</span>
  <span class="ruby-identifier">club</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">create!</span>
  <span class="ruby-identifier">member</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create!</span>
  <span class="ruby-constant">Membership</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">club</span><span class="ruby-operator">:</span> <span class="ruby-identifier">club</span>, <span class="ruby-identifier">member</span><span class="ruby-operator">:</span> <span class="ruby-identifier">member</span>)

  <span class="ruby-identifier">club</span>.<span class="ruby-identifier">favourites</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">member</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">member</span>], <span class="ruby-identifier">club</span>.<span class="ruby-identifier">favourites</span>

  <span class="ruby-identifier">club</span>.<span class="ruby-identifier">reload</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">member</span>], <span class="ruby-identifier">club</span>.<span class="ruby-identifier">favourites</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_joining_has_many_through_belongs_to">
            
              <b>test_joining_has_many_through_belongs_to</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_joining_has_many_through_belongs_to" name="method-i-test_joining_has_many_through_belongs_to" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_joining_has_many_through_belongs_to_source')" id="l_method-i-test_joining_has_many_through_belongs_to_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L948" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_joining_has_many_through_belongs_to_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 948</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_joining_has_many_through_belongs_to</span>
  <span class="ruby-identifier">posts</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">joins</span>(<span class="ruby-value">:author_categorizations</span>).<span class="ruby-identifier">order</span>(<span class="ruby-string">&#39;posts.id&#39;</span>).
               <span class="ruby-identifier">where</span>(<span class="ruby-string">&#39;categorizations.id&#39;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">categorizations</span>(<span class="ruby-value">:mary_thinking_sti</span>).<span class="ruby-identifier">id</span>)

  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">posts</span>(<span class="ruby-value">:eager_other</span>), <span class="ruby-identifier">posts</span>(<span class="ruby-value">:misc_by_mary</span>), <span class="ruby-identifier">posts</span>(<span class="ruby-value">:other_by_mary</span>)], <span class="ruby-identifier">posts</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_joining_has_many_through_with_uniq">
            
              <b>test_joining_has_many_through_with_uniq</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_joining_has_many_through_with_uniq" name="method-i-test_joining_has_many_through_with_uniq" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_joining_has_many_through_with_uniq_source')" id="l_method-i-test_joining_has_many_through_with_uniq_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L942" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_joining_has_many_through_with_uniq_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 942</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_joining_has_many_through_with_uniq</span>
  <span class="ruby-identifier">mary</span> = <span class="ruby-constant">Author</span>.<span class="ruby-identifier">joins</span>(<span class="ruby-value">:unique_categorized_posts</span>).<span class="ruby-identifier">where</span>(<span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>).<span class="ruby-identifier">id</span>).<span class="ruby-identifier">first</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">mary</span>.<span class="ruby-identifier">unique_categorized_posts</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">mary</span>.<span class="ruby-identifier">unique_categorized_post_ids</span>.<span class="ruby-identifier">length</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_merge_join_association_with_has_many_through_association_proxy">
            
              <b>test_merge_join_association_with_has_many_through_association_proxy</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_merge_join_association_with_has_many_through_association_proxy" name="method-i-test_merge_join_association_with_has_many_through_association_proxy" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_merge_join_association_with_has_many_through_association_proxy_source')" id="l_method-i-test_merge_join_association_with_has_many_through_association_proxy_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L767" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_merge_join_association_with_has_many_through_association_proxy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 767</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_merge_join_association_with_has_many_through_association_proxy</span>
  <span class="ruby-identifier">author</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:mary</span>)
  <span class="ruby-identifier">assert_nothing_raised</span> { <span class="ruby-identifier">author</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">ratings</span>.<span class="ruby-identifier">to_sql</span> }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_modifying_has_many_through_has_one_reflection_should_raise">
            
              <b>test_modifying_has_many_through_has_one_reflection_should_raise</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_modifying_has_many_through_has_one_reflection_should_raise" name="method-i-test_modifying_has_many_through_has_one_reflection_should_raise" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_modifying_has_many_through_has_one_reflection_should_raise_source')" id="l_method-i-test_modifying_has_many_through_has_one_reflection_should_raise_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L785" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_modifying_has_many_through_has_one_reflection_should_raise_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 785</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_modifying_has_many_through_has_one_reflection_should_raise</span>
  [
    <span class="ruby-identifier">lambda</span> { <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">very_special_comments</span> = [<span class="ruby-constant">VerySpecialComment</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Gorp!&quot;</span>, <span class="ruby-value">:post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1011</span>), <span class="ruby-constant">VerySpecialComment</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Eep!&quot;</span>, <span class="ruby-value">:post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1012</span>)] },
    <span class="ruby-identifier">lambda</span> { <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">very_special_comments</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">VerySpecialComment</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:body</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Hoohah!&quot;</span>, <span class="ruby-value">:post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-number">1013</span>) },
    <span class="ruby-identifier">lambda</span> { <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">very_special_comments</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">very_special_comments</span>.<span class="ruby-identifier">first</span>) },
  ].<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">block</span><span class="ruby-operator">|</span> <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">HasManyThroughCantAssociateThroughHasOneOrManyReflection</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_no_pk_join_model_callbacks">
            
              <b>test_no_pk_join_model_callbacks</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_no_pk_join_model_callbacks" name="method-i-test_no_pk_join_model_callbacks" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_no_pk_join_model_callbacks_source')" id="l_method-i-test_no_pk_join_model_callbacks_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L130" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_no_pk_join_model_callbacks_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 130</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_no_pk_join_model_callbacks</span>
  <span class="ruby-identifier">lesson</span>, <span class="ruby-identifier">lesson_student</span>, <span class="ruby-identifier">student</span> = <span class="ruby-identifier">make_no_pk_hm_t</span>

  <span class="ruby-identifier">after_destroy_called</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">lesson_student</span>.<span class="ruby-identifier">after_destroy</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">after_destroy_called</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">sicp</span> = <span class="ruby-identifier">lesson</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;SICP&quot;</span>)
  <span class="ruby-identifier">ben</span> = <span class="ruby-identifier">student</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Ben Bitdiddle&quot;</span>)
  <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ben</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">save!</span>

  <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span>.<span class="ruby-identifier">reload</span>
  <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">student</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">to_a</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">after_destroy_called</span>, <span class="ruby-string">&quot;after destroy should be called&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_no_pk_join_table_append">
            
              <b>test_no_pk_join_table_append</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_no_pk_join_table_append" name="method-i-test_no_pk_join_table_append" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_no_pk_join_table_append_source')" id="l_method-i-test_no_pk_join_table_append_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L102" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_no_pk_join_table_append_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 102</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_no_pk_join_table_append</span>
  <span class="ruby-identifier">lesson</span>, <span class="ruby-identifier">_</span>, <span class="ruby-identifier">student</span> = <span class="ruby-identifier">make_no_pk_hm_t</span>

  <span class="ruby-identifier">sicp</span> = <span class="ruby-identifier">lesson</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;SICP&quot;</span>)
  <span class="ruby-identifier">ben</span> = <span class="ruby-identifier">student</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Ben Bitdiddle&quot;</span>)
  <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ben</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">save!</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_no_pk_join_table_delete">
            
              <b>test_no_pk_join_table_delete</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_no_pk_join_table_delete" name="method-i-test_no_pk_join_table_delete" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_no_pk_join_table_delete_source')" id="l_method-i-test_no_pk_join_table_delete_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L111" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_no_pk_join_table_delete_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 111</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_no_pk_join_table_delete</span>
  <span class="ruby-identifier">lesson</span>, <span class="ruby-identifier">lesson_student</span>, <span class="ruby-identifier">student</span> = <span class="ruby-identifier">make_no_pk_hm_t</span>

  <span class="ruby-identifier">sicp</span> = <span class="ruby-identifier">lesson</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;SICP&quot;</span>)
  <span class="ruby-identifier">ben</span> = <span class="ruby-identifier">student</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Ben Bitdiddle&quot;</span>)
  <span class="ruby-identifier">louis</span> = <span class="ruby-identifier">student</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Louis Reasoner&quot;</span>)
  <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ben</span>
  <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">louis</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">save!</span>

  <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span>.<span class="ruby-identifier">reload</span>
  <span class="ruby-identifier">assert_operator</span> <span class="ruby-identifier">lesson_student</span>.<span class="ruby-identifier">count</span>, <span class="ruby-value">:&gt;=</span>, <span class="ruby-number">2</span>
  <span class="ruby-identifier">assert_no_difference</span>(<span class="ruby-string">&#39;student.count&#39;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span>(<span class="ruby-string">&#39;lesson_student.count&#39;</span>, <span class="ruby-number">-2</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">sicp</span>.<span class="ruby-identifier">students</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">student</span>.<span class="ruby-identifier">all</span>.<span class="ruby-identifier">to_a</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_ordered_habtm">
            
              <b>test_ordered_habtm</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_ordered_habtm" name="method-i-test_ordered_habtm" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_ordered_habtm_source')" id="l_method-i-test_ordered_habtm_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L64" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_ordered_habtm_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_ordered_habtm</span>
  <span class="ruby-identifier">person_prime</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">name</span>; <span class="ruby-string">&#39;Person&#39;</span>; <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">has_many</span> <span class="ruby-value">:readers</span>
    <span class="ruby-identifier">has_many</span> <span class="ruby-value">:posts</span>, <span class="ruby-operator">-</span><span class="ruby-operator">&gt;</span> { <span class="ruby-identifier">order</span>(<span class="ruby-string">&#39;posts.id DESC&#39;</span>) }, <span class="ruby-value">:through</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:readers</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">posts</span> = <span class="ruby-identifier">person_prime</span>.<span class="ruby-identifier">includes</span>(<span class="ruby-value">:posts</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">posts</span>

  <span class="ruby-identifier">assert_operator</span> <span class="ruby-identifier">posts</span>.<span class="ruby-identifier">length</span>, <span class="ruby-value">:&gt;</span>, <span class="ruby-number">1</span>
  <span class="ruby-identifier">posts</span>.<span class="ruby-identifier">each_cons</span>(<span class="ruby-number">2</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">left</span>,<span class="ruby-identifier">right</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assert_operator</span> <span class="ruby-identifier">left</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:&gt;</span>, <span class="ruby-identifier">right</span>.<span class="ruby-identifier">id</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_pk_is_not_required_for_join">
            
              <b>test_pk_is_not_required_for_join</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_pk_is_not_required_for_join" name="method-i-test_pk_is_not_required_for_join" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_pk_is_not_required_for_join_source')" id="l_method-i-test_pk_is_not_required_for_join_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L162" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_pk_is_not_required_for_join_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 162</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_pk_is_not_required_for_join</span>
  <span class="ruby-identifier">post</span>  = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">includes</span>(<span class="ruby-value">:scategories</span>).<span class="ruby-identifier">first</span>
  <span class="ruby-identifier">post2</span> = <span class="ruby-constant">Post</span>.<span class="ruby-identifier">includes</span>(<span class="ruby-value">:categories</span>).<span class="ruby-identifier">first</span>

  <span class="ruby-identifier">assert_operator</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">categories</span>.<span class="ruby-identifier">length</span>, <span class="ruby-value">:&gt;</span>, <span class="ruby-number">0</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">post2</span>.<span class="ruby-identifier">categories</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">categories</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_preload_sti_middle_relation">
            
              <b>test_preload_sti_middle_relation</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_preload_sti_middle_relation" name="method-i-test_preload_sti_middle_relation" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_preload_sti_middle_relation_source')" id="l_method-i-test_preload_sti_middle_relation_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L47" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_preload_sti_middle_relation_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_preload_sti_middle_relation</span>
  <span class="ruby-identifier">club</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Aaron cool banana club&#39;</span>)
  <span class="ruby-identifier">member1</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Aaron&#39;</span>)
  <span class="ruby-identifier">member2</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Cat&#39;</span>)

  <span class="ruby-constant">SuperMembership</span>.<span class="ruby-identifier">create!</span> <span class="ruby-identifier">club</span><span class="ruby-operator">:</span> <span class="ruby-identifier">club</span>, <span class="ruby-identifier">member</span><span class="ruby-operator">:</span> <span class="ruby-identifier">member1</span>
  <span class="ruby-constant">CurrentMembership</span>.<span class="ruby-identifier">create!</span> <span class="ruby-identifier">club</span><span class="ruby-operator">:</span> <span class="ruby-identifier">club</span>, <span class="ruby-identifier">member</span><span class="ruby-operator">:</span> <span class="ruby-identifier">member2</span>

  <span class="ruby-identifier">club1</span> = <span class="ruby-constant">Club</span>.<span class="ruby-identifier">includes</span>(<span class="ruby-value">:members</span>).<span class="ruby-identifier">find_by_id</span> <span class="ruby-identifier">club</span>.<span class="ruby-identifier">id</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">member1</span>, <span class="ruby-identifier">member2</span>].<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>),
               <span class="ruby-identifier">club1</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_preload_sti_rhs_class">
            
              <b>test_preload_sti_rhs_class</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_preload_sti_rhs_class" name="method-i-test_preload_sti_rhs_class" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_preload_sti_rhs_class_source')" id="l_method-i-test_preload_sti_rhs_class_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L40" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_preload_sti_rhs_class_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_preload_sti_rhs_class</span>
  <span class="ruby-identifier">developers</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">includes</span>(<span class="ruby-value">:firms</span>).<span class="ruby-identifier">all</span>.<span class="ruby-identifier">to_a</span>
  <span class="ruby-identifier">assert_no_queries</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">developers</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span> <span class="ruby-identifier">d</span>.<span class="ruby-identifier">firms</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_preloading_empty_through_association_via_joins">
            
              <b>test_preloading_empty_through_association_via_joins</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_preloading_empty_through_association_via_joins" name="method-i-test_preloading_empty_through_association_via_joins" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_preloading_empty_through_association_via_joins_source')" id="l_method-i-test_preloading_empty_through_association_via_joins_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1062" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_preloading_empty_through_association_via_joins_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1062</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_preloading_empty_through_association_via_joins</span>
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:first_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Gaga&quot;</span>)
  <span class="ruby-identifier">person</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">where</span>(<span class="ruby-string">&#39;readers.id = 1 or 1=1&#39;</span>).<span class="ruby-identifier">references</span>(<span class="ruby-value">:readers</span>).<span class="ruby-identifier">includes</span>(<span class="ruby-value">:posts</span>).<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">first</span>

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">loaded?</span>, <span class="ruby-string">&#39;person.posts should be loaded&#39;</span>
  <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">person</span>.<span class="ruby-identifier">posts</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_primary_key_option_on_source">
            
              <b>test_primary_key_option_on_source</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_primary_key_option_on_source" name="method-i-test_primary_key_option_on_source" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_primary_key_option_on_source_source')" id="l_method-i-test_primary_key_option_on_source_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1005" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_primary_key_option_on_source_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1005</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_primary_key_option_on_source</span>
  <span class="ruby-identifier">post</span>     = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>)
  <span class="ruby-identifier">category</span> = <span class="ruby-identifier">categories</span>(<span class="ruby-value">:general</span>)
  <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:post_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">id</span>, <span class="ruby-value">:named_category_name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">name</span>)

  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">category</span>], <span class="ruby-identifier">post</span>.<span class="ruby-identifier">named_categories</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">category</span>.<span class="ruby-identifier">name</span>], <span class="ruby-identifier">post</span>.<span class="ruby-identifier">named_category_ids</span> <span class="ruby-comment"># checks when target loaded</span>
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">category</span>.<span class="ruby-identifier">name</span>], <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">named_category_ids</span> <span class="ruby-comment"># checks when target no loaded</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_push_with_invalid_join_record">
            
              <b>test_push_with_invalid_join_record</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_push_with_invalid_join_record" name="method-i-test_push_with_invalid_join_record" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_push_with_invalid_join_record_source')" id="l_method-i-test_push_with_invalid_join_record_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L633" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_push_with_invalid_join_record_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 633</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_push_with_invalid_join_record</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Contract</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Contract</span>.<span class="ruby-identifier">validate</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:base</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;Invalid Contract&#39;</span> }

    <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:first_firm</span>)
    <span class="ruby-identifier">lifo</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;lifo&#39;</span>)
    <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">developers</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lifo</span> }

    <span class="ruby-identifier">lifo</span> = <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;lifo&#39;</span>)
    <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">developers</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lifo</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_push_with_invalid_record">
            
              <b>test_push_with_invalid_record</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_push_with_invalid_record" name="method-i-test_push_with_invalid_record" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_push_with_invalid_record_source')" id="l_method-i-test_push_with_invalid_record_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L628" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_push_with_invalid_record_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 628</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_push_with_invalid_record</span>
  <span class="ruby-identifier">firm</span> = <span class="ruby-identifier">companies</span>(<span class="ruby-value">:first_firm</span>)
  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) { <span class="ruby-identifier">firm</span>.<span class="ruby-identifier">developers</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Developer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;0&#39;</span>) }
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_replace_association">
            
              <b>test_replace_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_replace_association" name="method-i-test_replace_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_replace_association_source')" id="l_method-i-test_replace_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L526" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_replace_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 526</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_replace_association</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">4</span>){<span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>);<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>);<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>); <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>)}

  <span class="ruby-comment"># 1 query to delete the existing reader (michael)</span>
  <span class="ruby-comment"># 1 query to associate the new reader (david)</span>
  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">2</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span> = [<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)]
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">assert_queries</span>(<span class="ruby-number">0</span>){
    <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>))
    <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>))
  }

  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>))
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">reload</span>.<span class="ruby-identifier">people</span>(<span class="ruby-keyword">true</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>))
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_replace_by_id_order_is_preserved">
            
              <b>test_replace_by_id_order_is_preserved</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_replace_by_id_order_is_preserved" name="method-i-test_replace_by_id_order_is_preserved" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_replace_by_id_order_is_preserved_source')" id="l_method-i-test_replace_by_id_order_is_preserved_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L555" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_replace_by_id_order_is_preserved_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 555</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_replace_by_id_order_is_preserved</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">person_ids</span> = [<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">id</span>]
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">order</span>(<span class="ruby-string">&#39;id&#39;</span>).<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:person_id</span>)

  <span class="ruby-comment"># Test the inverse order in case the first success was a coincidence</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">person_ids</span> = [<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">id</span>]
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">order</span>(<span class="ruby-string">&#39;id&#39;</span>).<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:person_id</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_replace_order_is_preserved">
            
              <b>test_replace_order_is_preserved</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_replace_order_is_preserved" name="method-i-test_replace_order_is_preserved" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_replace_order_is_preserved_source')" id="l_method-i-test_replace_order_is_preserved_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L544" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_replace_order_is_preserved_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 544</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_replace_order_is_preserved</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span> = [<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>), <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)]
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">order</span>(<span class="ruby-string">&#39;id&#39;</span>).<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:person_id</span>)

  <span class="ruby-comment"># Test the inverse order in case the first success was a coincidence</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">clear</span>
  <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span> = [<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>), <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>)]
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">id</span>, <span class="ruby-identifier">people</span>(<span class="ruby-value">:david</span>).<span class="ruby-identifier">id</span>], <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">order</span>(<span class="ruby-string">&#39;id&#39;</span>).<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:person_id</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_save_bang_should_raise_exception_when_join_record_has_errors">
            
              <b>test_save_bang_should_raise_exception_when_join_record_has_errors</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_save_bang_should_raise_exception_when_join_record_has_errors" name="method-i-test_save_bang_should_raise_exception_when_join_record_has_errors" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_save_bang_should_raise_exception_when_join_record_has_errors_source')" id="l_method-i-test_save_bang_should_raise_exception_when_join_record_has_errors_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1044" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_save_bang_should_raise_exception_when_join_record_has_errors_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1044</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_save_bang_should_raise_exception_when_join_record_has_errors</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Categorization</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:base</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;Invalid Categorization&#39;</span> }
    <span class="ruby-identifier">c</span> = <span class="ruby-constant">Category</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Fishing&#39;</span>, <span class="ruby-value">:authors</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">Author</span>.<span class="ruby-identifier">first</span>])
    <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordInvalid</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">c</span>.<span class="ruby-identifier">save!</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_save_should_not_raise_exception_when_join_record_has_errors">
            
              <b>test_save_should_not_raise_exception_when_join_record_has_errors</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_save_should_not_raise_exception_when_join_record_has_errors" name="method-i-test_save_should_not_raise_exception_when_join_record_has_errors" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_save_should_not_raise_exception_when_join_record_has_errors_source')" id="l_method-i-test_save_should_not_raise_exception_when_join_record_has_errors_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L1022" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_save_should_not_raise_exception_when_join_record_has_errors_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 1022</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_save_should_not_raise_exception_when_join_record_has_errors</span>
  <span class="ruby-identifier">repair_validations</span>(<span class="ruby-constant">Categorization</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">Categorization</span>.<span class="ruby-identifier">validate</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">errors</span>[<span class="ruby-value">:base</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&#39;Invalid Categorization&#39;</span> }
    <span class="ruby-identifier">c</span> = <span class="ruby-constant">Category</span>.<span class="ruby-identifier">create</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;Fishing&#39;</span>, <span class="ruby-value">:authors</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">Author</span>.<span class="ruby-identifier">first</span>])
    <span class="ruby-identifier">c</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_select_chosen_fields_only">
            
              <b>test_select_chosen_fields_only</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_select_chosen_fields_only" name="method-i-test_select_chosen_fields_only" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_select_chosen_fields_only_source')" id="l_method-i-test_select_chosen_fields_only_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L955" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_select_chosen_fields_only_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 955</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_select_chosen_fields_only</span>
  <span class="ruby-identifier">author</span> = <span class="ruby-identifier">authors</span>(<span class="ruby-value">:david</span>)
  <span class="ruby-identifier">assert_equal</span> [<span class="ruby-string">&#39;body&#39;</span>, <span class="ruby-string">&#39;id&#39;</span>].<span class="ruby-identifier">sort</span>, <span class="ruby-identifier">author</span>.<span class="ruby-identifier">comments</span>.<span class="ruby-identifier">select</span>(<span class="ruby-string">&#39;comments.body&#39;</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_should_raise_exception_for_destroying_mismatching_records">
            
              <b>test_should_raise_exception_for_destroying_mismatching_records</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_should_raise_exception_for_destroying_mismatching_records" name="method-i-test_should_raise_exception_for_destroying_mismatching_records" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_should_raise_exception_for_destroying_mismatching_records_source')" id="l_method-i-test_should_raise_exception_for_destroying_mismatching_records_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L369" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_should_raise_exception_for_destroying_mismatching_records_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 369</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_should_raise_exception_for_destroying_mismatching_records</span>
  <span class="ruby-identifier">assert_no_difference</span> [<span class="ruby-string">&quot;Person.count&quot;</span>, <span class="ruby-string">&quot;Reader.count&quot;</span>] <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">AssociationTypeMismatch</span>) { <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">people</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)) }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_singleton_has_many_through">
            
              <b>test_singleton_has_many_through</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_singleton_has_many_through" name="method-i-test_singleton_has_many_through" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_singleton_has_many_through_source')" id="l_method-i-test_singleton_has_many_through_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L79" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_singleton_has_many_through_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_singleton_has_many_through</span>
  <span class="ruby-identifier">book</span>         = <span class="ruby-identifier">make_model</span> <span class="ruby-string">&quot;Book&quot;</span>
  <span class="ruby-identifier">subscription</span> = <span class="ruby-identifier">make_model</span> <span class="ruby-string">&quot;Subscription&quot;</span>
  <span class="ruby-identifier">subscriber</span>   = <span class="ruby-identifier">make_model</span> <span class="ruby-string">&quot;Subscriber&quot;</span>

  <span class="ruby-identifier">subscriber</span>.<span class="ruby-identifier">primary_key</span> = <span class="ruby-string">&#39;nick&#39;</span>
  <span class="ruby-identifier">subscription</span>.<span class="ruby-identifier">belongs_to</span> <span class="ruby-value">:book</span>,       <span class="ruby-identifier">class</span><span class="ruby-operator">:</span> <span class="ruby-identifier">book</span>
  <span class="ruby-identifier">subscription</span>.<span class="ruby-identifier">belongs_to</span> <span class="ruby-value">:subscriber</span>, <span class="ruby-identifier">class</span><span class="ruby-operator">:</span> <span class="ruby-identifier">subscriber</span>

  <span class="ruby-identifier">book</span>.<span class="ruby-identifier">has_many</span> <span class="ruby-value">:subscriptions</span>, <span class="ruby-identifier">class</span><span class="ruby-operator">:</span> <span class="ruby-identifier">subscription</span>
  <span class="ruby-identifier">book</span>.<span class="ruby-identifier">has_many</span> <span class="ruby-value">:subscribers</span>, <span class="ruby-identifier">through</span><span class="ruby-operator">:</span> <span class="ruby-value">:subscriptions</span>, <span class="ruby-identifier">class</span><span class="ruby-operator">:</span> <span class="ruby-identifier">subscriber</span>

  <span class="ruby-identifier">anonbook</span> = <span class="ruby-identifier">book</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-identifier">namebook</span> = <span class="ruby-constant">Book</span>.<span class="ruby-identifier">find</span> <span class="ruby-identifier">anonbook</span>.<span class="ruby-identifier">id</span>

  <span class="ruby-identifier">assert_operator</span> <span class="ruby-identifier">anonbook</span>.<span class="ruby-identifier">subscribers</span>.<span class="ruby-identifier">count</span>, <span class="ruby-value">:&gt;</span>, <span class="ruby-number">0</span>
  <span class="ruby-identifier">anonbook</span>.<span class="ruby-identifier">subscribers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assert_instance_of</span> <span class="ruby-identifier">subscriber</span>, <span class="ruby-identifier">s</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">namebook</span>.<span class="ruby-identifier">subscribers</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>).<span class="ruby-identifier">sort</span>,
               <span class="ruby-identifier">anonbook</span>.<span class="ruby-identifier">subscribers</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:id</span>).<span class="ruby-identifier">sort</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added">
            
              <b>test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added" name="method-i-test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added_source')" id="l_method-i-test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L926" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 926</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_size_of_through_association_should_increase_correctly_when_has_many_association_is_added</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)
  <span class="ruby-identifier">readers</span> = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">people</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">readers</span> <span class="ruby-operator">+</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">readers</span>.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_through_association_readonly_should_be_false">
            
              <b>test_through_association_readonly_should_be_false</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_through_association_readonly_should_be_false" name="method-i-test_through_association_readonly_should_be_false" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_through_association_readonly_should_be_false_source')" id="l_method-i-test_through_association_readonly_should_be_false_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L896" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_through_association_readonly_should_be_false_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 896</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_through_association_readonly_should_be_false</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">readonly?</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-operator">!</span><span class="ruby-identifier">people</span>(<span class="ruby-value">:michael</span>).<span class="ruby-identifier">posts</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">readonly?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_update_counter_caches_on_delete">
            
              <b>test_update_counter_caches_on_delete</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_update_counter_caches_on_delete" name="method-i-test_update_counter_caches_on_delete" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_update_counter_caches_on_delete_source')" id="l_method-i-test_update_counter_caches_on_delete_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L475" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_update_counter_caches_on_delete_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 475</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_update_counter_caches_on_delete</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>)
  <span class="ruby-identifier">tag</span>  = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;doomed&#39;</span>)

  <span class="ruby-identifier">assert_difference</span> [<span class="ruby-string">&#39;post.reload.taggings_count&#39;</span>, <span class="ruby-string">&#39;post.reload.tags_count&#39;</span>], <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_update_counter_caches_on_delete_with_dependent_destroy">
            
              <b>test_update_counter_caches_on_delete_with_dependent_destroy</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_update_counter_caches_on_delete_with_dependent_destroy" name="method-i-test_update_counter_caches_on_delete_with_dependent_destroy" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_update_counter_caches_on_delete_with_dependent_destroy_source')" id="l_method-i-test_update_counter_caches_on_delete_with_dependent_destroy_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L484" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_update_counter_caches_on_delete_with_dependent_destroy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 484</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_update_counter_caches_on_delete_with_dependent_destroy</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>)
  <span class="ruby-identifier">tag</span>  = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;doomed&#39;</span>)
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">update_columns</span>(<span class="ruby-identifier">tags_with_destroy_count</span><span class="ruby-operator">:</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">count</span>)

  <span class="ruby-identifier">assert_difference</span> [<span class="ruby-string">&#39;post.reload.taggings_count&#39;</span>, <span class="ruby-string">&#39;post.reload.tags_with_destroy_count&#39;</span>], <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">tags_with_destroy</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">tag</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_update_counter_caches_on_delete_with_dependent_nullify">
            
              <b>test_update_counter_caches_on_delete_with_dependent_nullify</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_update_counter_caches_on_delete_with_dependent_nullify" name="method-i-test_update_counter_caches_on_delete_with_dependent_nullify" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_update_counter_caches_on_delete_with_dependent_nullify_source')" id="l_method-i-test_update_counter_caches_on_delete_with_dependent_nullify_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L494" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_update_counter_caches_on_delete_with_dependent_nullify_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 494</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_update_counter_caches_on_delete_with_dependent_nullify</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>)
  <span class="ruby-identifier">tag</span>  = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;doomed&#39;</span>)
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">update_columns</span>(<span class="ruby-identifier">tags_with_nullify_count</span><span class="ruby-operator">:</span> <span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">count</span>)

  <span class="ruby-identifier">assert_no_difference</span> <span class="ruby-string">&#39;post.reload.taggings_count&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;post.reload.tags_with_nullify_count&#39;</span>, <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>).<span class="ruby-identifier">tags_with_nullify</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">tag</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_update_counter_caches_on_destroy">
            
              <b>test_update_counter_caches_on_destroy</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_update_counter_caches_on_destroy" name="method-i-test_update_counter_caches_on_destroy" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_update_counter_caches_on_destroy_source')" id="l_method-i-test_update_counter_caches_on_destroy_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L517" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_update_counter_caches_on_destroy_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 517</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_update_counter_caches_on_destroy</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>)
  <span class="ruby-identifier">tag</span>  = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;doomed&#39;</span>)

  <span class="ruby-identifier">assert_difference</span> <span class="ruby-string">&#39;post.reload.taggings_count&#39;</span>, <span class="ruby-number">-1</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">tag</span>.<span class="ruby-identifier">tagged_posts</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">post</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_update_counter_caches_on_replace_association">
            
              <b>test_update_counter_caches_on_replace_association</b>()
            
            <a href="../classes/HasManyThroughAssociationsTest.html#method-i-test_update_counter_caches_on_replace_association" name="method-i-test_update_counter_caches_on_replace_association" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_update_counter_caches_on_replace_association_source')" id="l_method-i-test_update_counter_caches_on_replace_association_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/a44feedc8aaf861830b39b855b510fdefc395195/activerecord/test/cases/associations/has_many_through_associations_test.rb#L506" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_update_counter_caches_on_replace_association_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/associations/has_many_through_associations_test.rb, line 506</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_update_counter_caches_on_replace_association</span>
  <span class="ruby-identifier">post</span> = <span class="ruby-identifier">posts</span>(<span class="ruby-value">:welcome</span>)
  <span class="ruby-identifier">tag</span>  = <span class="ruby-identifier">post</span>.<span class="ruby-identifier">tags</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;doomed&#39;</span>)
  <span class="ruby-identifier">tag</span>.<span class="ruby-identifier">tagged_posts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">posts</span>(<span class="ruby-value">:thinking</span>)

  <span class="ruby-identifier">tag</span>.<span class="ruby-identifier">tagged_posts</span> = []
  <span class="ruby-identifier">post</span>.<span class="ruby-identifier">reload</span>

  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-identifier">post</span>.<span class="ruby-identifier">taggings</span>.<span class="ruby-identifier">count</span>, <span class="ruby-identifier">post</span>.<span class="ruby-identifier">taggings_count</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    