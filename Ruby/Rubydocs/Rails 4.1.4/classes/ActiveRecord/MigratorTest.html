<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ActiveRecord::MigratorTest</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            ActiveRecord::MigratorTest 
            
                <span class="parent">&lt; 
                    
                    ActiveRecord::TestCase
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/activerecord/test/cases/migrator_test_rb.html">activerecord/test/cases/migrator_test.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  
    <!-- Namespace -->
    <div class="sectiontitle">Namespace</div>
    <ul>
      
        <li>
          <span class="type">CLASS</span>
          <a href="MigratorTest/Sensor.html">ActiveRecord::MigratorTest::Sensor</a>
        </li>
      
    </ul>
  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-setup">setup</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-teardown">teardown</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_current_version">test_current_version</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_down_calls_down">test_down_calls_down</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_finds_migrations">test_finds_migrations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_finds_migrations_from_two_directories">test_finds_migrations_from_two_directories</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_finds_migrations_in_numbered_directory">test_finds_migrations_in_numbered_directory</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_finds_migrations_in_subdirectories">test_finds_migrations_in_subdirectories</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_finds_pending_migrations">test_finds_pending_migrations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_get_all_versions">test_get_all_versions</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_db_has_no_schema_migrations_table">test_migrator_db_has_no_schema_migrations_table</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_double_down">test_migrator_double_down</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_double_up">test_migrator_double_up</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_forward">test_migrator_forward</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_going_down_due_to_version_target">test_migrator_going_down_due_to_version_target</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_interleaved_migrations">test_migrator_interleaved_migrations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_one_down">test_migrator_one_down</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_one_up">test_migrator_one_up</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_one_up_one_down">test_migrator_one_up_one_down</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_rollback">test_migrator_rollback</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_verbosity">test_migrator_verbosity</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_verbosity_off">test_migrator_verbosity_off</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_with_duplicate_names">test_migrator_with_duplicate_names</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_with_duplicate_versions">test_migrator_with_duplicate_versions</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_migrator_with_missing_version_numbers">test_migrator_with_missing_version_numbers</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_only_loads_pending_migrations">test_only_loads_pending_migrations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_relative_migrations">test_relative_migrations</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_target_version_zero_should_run_only_once">test_target_version_zero_should_run_only_once</a>,
              </li>
            
              
              <li>
                <a href="#method-i-test_up_calls_up">test_up_calls_up</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
        
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-setup">
            
              <b>setup</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-setup" name="method-i-setup" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-setup_source')" id="l_method-i-setup_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L23" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-setup_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 23</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">setup</span>
  <span class="ruby-keyword">super</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">create_table</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">delete_all</span> <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-teardown">
            
              <b>teardown</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-teardown" name="method-i-teardown" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-teardown_source')" id="l_method-i-teardown_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L29" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-teardown_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 29</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">teardown</span>
  <span class="ruby-keyword">super</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">delete_all</span> <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">verbose</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_current_version">
            
              <b>test_current_version</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_current_version" name="method-i-test_current_version" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_current_version_source')" id="l_method-i-test_current_version_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L155" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_current_version_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 155</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_current_version</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:version</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;1000&#39;</span>)
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1000</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_down_calls_down">
            
              <b>test_down_calls_down</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_down_calls_down" name="method-i-test_down_calls_down" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_down_calls_down_source')" id="l_method-i-test_down_calls_down_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L145" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_down_calls_down_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 145</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_down_calls_down</span>
  <span class="ruby-identifier">test_up_calls_up</span>

  <span class="ruby-identifier">migrations</span> = [<span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-number">0</span>), <span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-number">1</span>), <span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-number">2</span>)]
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">migrations</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">m</span>.<span class="ruby-identifier">went_up</span> }
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">migrations</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">went_down</span> }
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_finds_migrations">
            
              <b>test_finds_migrations</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_finds_migrations" name="method-i-test_finds_migrations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_finds_migrations_source')" id="l_method-i-test_finds_migrations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L56" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_finds_migrations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_finds_migrations</span>
  <span class="ruby-identifier">migrations</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">migrations</span>(<span class="ruby-constant">MIGRATIONS_ROOT</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/valid&quot;</span>)

  [[<span class="ruby-number">1</span>, <span class="ruby-string">&#39;ValidPeopleHaveLastNames&#39;</span>], [<span class="ruby-number">2</span>, <span class="ruby-string">&#39;WeNeedReminders&#39;</span>], [<span class="ruby-number">3</span>, <span class="ruby-string">&#39;InnocentJointable&#39;</span>]].<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">migrations</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">version</span>, <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">migrations</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">name</span>, <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">last</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_finds_migrations_from_two_directories">
            
              <b>test_finds_migrations_from_two_directories</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_finds_migrations_from_two_directories" name="method-i-test_finds_migrations_from_two_directories" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_finds_migrations_from_two_directories_source')" id="l_method-i-test_finds_migrations_from_two_directories_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L74" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_finds_migrations_from_two_directories_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_finds_migrations_from_two_directories</span>
  <span class="ruby-identifier">directories</span> = [<span class="ruby-constant">MIGRATIONS_ROOT</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/valid_with_timestamps&#39;</span>, <span class="ruby-constant">MIGRATIONS_ROOT</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/to_copy_with_timestamps&#39;</span>]
  <span class="ruby-identifier">migrations</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">migrations</span> <span class="ruby-identifier">directories</span>

  [[<span class="ruby-number">20090101010101</span>, <span class="ruby-string">&quot;PeopleHaveHobbies&quot;</span>],
   [<span class="ruby-number">20090101010202</span>, <span class="ruby-string">&quot;PeopleHaveDescriptions&quot;</span>],
   [<span class="ruby-number">20100101010101</span>, <span class="ruby-string">&quot;ValidWithTimestampsPeopleHaveLastNames&quot;</span>],
   [<span class="ruby-number">20100201010101</span>, <span class="ruby-string">&quot;ValidWithTimestampsWeNeedReminders&quot;</span>],
   [<span class="ruby-number">20100301010101</span>, <span class="ruby-string">&quot;ValidWithTimestampsInnocentJointable&quot;</span>]].<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">first</span>, <span class="ruby-identifier">migrations</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">version</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">last</span>, <span class="ruby-identifier">migrations</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">name</span>
   <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_finds_migrations_in_numbered_directory">
            
              <b>test_finds_migrations_in_numbered_directory</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_finds_migrations_in_numbered_directory" name="method-i-test_finds_migrations_in_numbered_directory" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_finds_migrations_in_numbered_directory_source')" id="l_method-i-test_finds_migrations_in_numbered_directory_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L88" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_finds_migrations_in_numbered_directory_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 88</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_finds_migrations_in_numbered_directory</span>
  <span class="ruby-identifier">migrations</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">migrations</span> [<span class="ruby-constant">MIGRATIONS_ROOT</span> <span class="ruby-operator">+</span> <span class="ruby-string">&#39;/10_urban&#39;</span>]
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">9</span>, <span class="ruby-identifier">migrations</span>[<span class="ruby-number">0</span>].<span class="ruby-identifier">version</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-string">&#39;AddExpressions&#39;</span>, <span class="ruby-identifier">migrations</span>[<span class="ruby-number">0</span>].<span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_finds_migrations_in_subdirectories">
            
              <b>test_finds_migrations_in_subdirectories</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_finds_migrations_in_subdirectories" name="method-i-test_finds_migrations_in_subdirectories" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_finds_migrations_in_subdirectories_source')" id="l_method-i-test_finds_migrations_in_subdirectories_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L65" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_finds_migrations_in_subdirectories_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_finds_migrations_in_subdirectories</span>
  <span class="ruby-identifier">migrations</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">migrations</span>(<span class="ruby-constant">MIGRATIONS_ROOT</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;/valid_with_subdirectories&quot;</span>)

  [[<span class="ruby-number">1</span>, <span class="ruby-string">&#39;ValidPeopleHaveLastNames&#39;</span>], [<span class="ruby-number">2</span>, <span class="ruby-string">&#39;WeNeedReminders&#39;</span>], [<span class="ruby-number">3</span>, <span class="ruby-string">&#39;InnocentJointable&#39;</span>]].<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">migrations</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">version</span>, <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">migrations</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">name</span>, <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">last</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_finds_pending_migrations">
            
              <b>test_finds_pending_migrations</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_finds_pending_migrations" name="method-i-test_finds_pending_migrations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_finds_pending_migrations_source')" id="l_method-i-test_finds_pending_migrations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L105" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_finds_pending_migrations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 105</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_finds_pending_migrations</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:version</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;1&#39;</span>)
  <span class="ruby-identifier">migration_list</span> = [ <span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;foo&#39;</span>, <span class="ruby-number">1</span>), <span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;bar&#39;</span>, <span class="ruby-number">3</span>) ]
  <span class="ruby-identifier">migrations</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migration_list</span>).<span class="ruby-identifier">pending_migrations</span>

  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">1</span>, <span class="ruby-identifier">migrations</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-identifier">migration_list</span>.<span class="ruby-identifier">last</span>, <span class="ruby-identifier">migrations</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_get_all_versions">
            
              <b>test_get_all_versions</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_get_all_versions" name="method-i-test_get_all_versions" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_get_all_versions_source')" id="l_method-i-test_get_all_versions_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L332" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_get_all_versions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 332</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_get_all_versions</span>
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">migrator</span> = <span class="ruby-identifier">migrator_class</span>(<span class="ruby-number">3</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>([<span class="ruby-number">1</span>,<span class="ruby-number">2</span>,<span class="ruby-number">3</span>], <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">get_all_versions</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">rollback</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>([<span class="ruby-number">1</span>,<span class="ruby-number">2</span>], <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">get_all_versions</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">rollback</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>([<span class="ruby-number">1</span>], <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">get_all_versions</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">rollback</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>([], <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">get_all_versions</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_db_has_no_schema_migrations_table">
            
              <b>test_migrator_db_has_no_schema_migrations_table</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_db_has_no_schema_migrations_table" name="method-i-test_migrator_db_has_no_schema_migrations_table" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_db_has_no_schema_migrations_table_source')" id="l_method-i-test_migrator_db_has_no_schema_migrations_table_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L301" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_db_has_no_schema_migrations_table_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 301</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_db_has_no_schema_migrations_table</span>
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">migrator</span> = <span class="ruby-identifier">migrator_class</span>(<span class="ruby-number">3</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-string">&quot;DROP TABLE schema_migrations&quot;</span>)
  <span class="ruby-identifier">assert_not</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">table_exists?</span>(<span class="ruby-string">&#39;schema_migrations&#39;</span>)
  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-string">&quot;valid&quot;</span>, <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">table_exists?</span>(<span class="ruby-string">&#39;schema_migrations&#39;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_double_down">
            
              <b>test_migrator_double_down</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_double_down" name="method-i-test_migrator_double_down" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_double_down_source')" id="l_method-i-test_migrator_double_down_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L206" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_double_down_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 206</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_double_down</span>
  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)

  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">run</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">run</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:down</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">run</span>
  <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">calls</span>

  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_double_up">
            
              <b>test_migrator_double_up</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_double_up" name="method-i-test_migrator_double_up" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_double_up_source')" id="l_method-i-test_migrator_double_up_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L194" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_double_up_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 194</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_double_up</span>
  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">calls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_forward">
            
              <b>test_migrator_forward</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_forward" name="method-i-test_migrator_forward" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_forward_source')" id="l_method-i-test_migrator_forward_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L310" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_forward_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 310</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_forward</span>
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">migrator</span> = <span class="ruby-identifier">migrator_class</span>(<span class="ruby-number">3</span>)
  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-string">&quot;/valid&quot;</span>, <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">1</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">forward</span>(<span class="ruby-string">&quot;/valid&quot;</span>, <span class="ruby-number">2</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">3</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">forward</span>(<span class="ruby-string">&quot;/valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">3</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_going_down_due_to_version_target">
            
              <b>test_migrator_going_down_due_to_version_target</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_going_down_due_to_version_target" name="method-i-test_migrator_going_down_due_to_version_target" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_going_down_due_to_version_target_source')" id="l_method-i-test_migrator_going_down_due_to_version_target_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L267" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_going_down_due_to_version_target_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 267</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_going_down_due_to_version_target</span>
  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrator</span> = <span class="ruby-identifier">migrator_class</span>(<span class="ruby-number">3</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">up</span>(<span class="ruby-string">&quot;valid&quot;</span>, <span class="ruby-number">1</span>)
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-string">&quot;valid&quot;</span>, <span class="ruby-number">0</span>)
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:down</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>], [<span class="ruby-value">:up</span>, <span class="ruby-number">2</span>], [<span class="ruby-value">:up</span>, <span class="ruby-number">3</span>]], <span class="ruby-identifier">calls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_interleaved_migrations">
            
              <b>test_migrator_interleaved_migrations</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_interleaved_migrations" name="method-i-test_migrator_interleaved_migrations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_interleaved_migrations_source')" id="l_method-i-test_migrator_interleaved_migrations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L114" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_interleaved_migrations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 114</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_interleaved_migrations</span>
  <span class="ruby-identifier">pass_one</span> = [<span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;One&#39;</span>, <span class="ruby-number">1</span>)]

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">pass_one</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">pass_one</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">went_up</span>
  <span class="ruby-identifier">assert_not</span> <span class="ruby-identifier">pass_one</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">went_down</span>

  <span class="ruby-identifier">pass_two</span> = [<span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;One&#39;</span>, <span class="ruby-number">1</span>), <span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Three&#39;</span>, <span class="ruby-number">3</span>)]
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">pass_two</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_not</span> <span class="ruby-identifier">pass_two</span>[<span class="ruby-number">0</span>].<span class="ruby-identifier">went_up</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">pass_two</span>[<span class="ruby-number">1</span>].<span class="ruby-identifier">went_up</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">pass_two</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">x</span>.<span class="ruby-identifier">went_down</span> }

  <span class="ruby-identifier">pass_three</span> = [<span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;One&#39;</span>, <span class="ruby-number">1</span>),
                <span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Two&#39;</span>, <span class="ruby-number">2</span>),
                <span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Three&#39;</span>, <span class="ruby-number">3</span>)]

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">pass_three</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">pass_three</span>[<span class="ruby-number">0</span>].<span class="ruby-identifier">went_down</span>
  <span class="ruby-identifier">assert_not</span> <span class="ruby-identifier">pass_three</span>[<span class="ruby-number">1</span>].<span class="ruby-identifier">went_down</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">pass_three</span>[<span class="ruby-number">2</span>].<span class="ruby-identifier">went_down</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_one_down">
            
              <b>test_migrator_one_down</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_one_down" name="method-i-test_migrator_one_down" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_one_down_source')" id="l_method-i-test_migrator_one_down_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L171" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_one_down_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_one_down</span>
  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>], [<span class="ruby-value">:up</span>, <span class="ruby-number">2</span>], [<span class="ruby-value">:up</span>, <span class="ruby-number">3</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>

  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:down</span>, <span class="ruby-number">3</span>], [<span class="ruby-value">:down</span>, <span class="ruby-number">2</span>]], <span class="ruby-identifier">calls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_one_up">
            
              <b>test_migrator_one_up</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_one_up" name="method-i-test_migrator_one_up" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_one_up_source')" id="l_method-i-test_migrator_one_up_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L160" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_one_up_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 160</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_one_up</span>
  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">2</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">2</span>]], <span class="ruby-identifier">calls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_one_up_one_down">
            
              <b>test_migrator_one_up_one_down</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_one_up_one_down" name="method-i-test_migrator_one_up_one_down" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_one_up_one_down_source')" id="l_method-i-test_migrator_one_up_one_down_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L183" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_one_up_one_down_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 183</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_one_up_one_down</span>
  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">0</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:down</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_rollback">
            
              <b>test_migrator_rollback</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_rollback" name="method-i-test_migrator_rollback" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_rollback_source')" id="l_method-i-test_migrator_rollback_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L282" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_rollback_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 282</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_rollback</span>
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">migrator</span> = <span class="ruby-identifier">migrator_class</span>(<span class="ruby-number">3</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">3</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">rollback</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">2</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">rollback</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">1</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">rollback</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)

  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">rollback</span>(<span class="ruby-string">&quot;valid&quot;</span>)
  <span class="ruby-identifier">assert_equal</span>(<span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_verbosity">
            
              <b>test_migrator_verbosity</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_verbosity" name="method-i-test_migrator_verbosity" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_verbosity_source')" id="l_method-i-test_migrator_verbosity_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L225" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_verbosity_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 225</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_verbosity</span>
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">message_count</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">message_count</span> = <span class="ruby-number">0</span>

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">0</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_not_equal</span> <span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">message_count</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">message_count</span> = <span class="ruby-number">0</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_verbosity_off">
            
              <b>test_migrator_verbosity_off</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_verbosity_off" name="method-i-test_migrator_verbosity_off" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_verbosity_off_source')" id="l_method-i-test_migrator_verbosity_off_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L238" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_verbosity_off_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 238</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_verbosity_off</span>
  <span class="ruby-identifier">_</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)

  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">message_count</span> = <span class="ruby-number">0</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">verbose</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">message_count</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">0</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">0</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span>.<span class="ruby-identifier">message_count</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_with_duplicate_names">
            
              <b>test_migrator_with_duplicate_names</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_with_duplicate_names" name="method-i-test_migrator_with_duplicate_names" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_with_duplicate_names_source')" id="l_method-i-test_migrator_with_duplicate_names_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L35" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_with_duplicate_names_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 35</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_with_duplicate_names</span>
  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">DuplicateMigrationNameError</span>, <span class="ruby-string">&quot;Multiple migrations have the name Chunky&quot;</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">list</span> = [<span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Chunky&#39;</span>), <span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Chunky&#39;</span>)]
    <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">list</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_with_duplicate_versions">
            
              <b>test_migrator_with_duplicate_versions</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_with_duplicate_versions" name="method-i-test_migrator_with_duplicate_versions" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_with_duplicate_versions_source')" id="l_method-i-test_migrator_with_duplicate_versions_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L42" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_with_duplicate_versions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_with_duplicate_versions</span>
  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">DuplicateMigrationVersionError</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">list</span> = [<span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Foo&#39;</span>, <span class="ruby-number">1</span>), <span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Bar&#39;</span>, <span class="ruby-number">1</span>)]
    <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">list</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_migrator_with_missing_version_numbers">
            
              <b>test_migrator_with_missing_version_numbers</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_migrator_with_missing_version_numbers" name="method-i-test_migrator_with_missing_version_numbers" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_migrator_with_missing_version_numbers_source')" id="l_method-i-test_migrator_with_missing_version_numbers_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L49" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_migrator_with_missing_version_numbers_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 49</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_migrator_with_missing_version_numbers</span>
  <span class="ruby-identifier">assert_raises</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">UnknownMigrationVersionError</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">list</span> = [<span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Foo&#39;</span>, <span class="ruby-number">1</span>), <span class="ruby-constant">Migration</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&#39;Bar&#39;</span>, <span class="ruby-number">2</span>)]
    <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">list</span>, <span class="ruby-number">3</span>).<span class="ruby-identifier">run</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_only_loads_pending_migrations">
            
              <b>test_only_loads_pending_migrations</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_only_loads_pending_migrations" name="method-i-test_only_loads_pending_migrations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_only_loads_pending_migrations_source')" id="l_method-i-test_only_loads_pending_migrations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L322" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_only_loads_pending_migrations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 322</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_only_loads_pending_migrations</span>
  <span class="ruby-comment"># migrate up to 1</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-value">:version</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&#39;1&#39;</span>)

  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrator</span> = <span class="ruby-identifier">migrator_class</span>(<span class="ruby-number">3</span>)
  <span class="ruby-identifier">migrator</span>.<span class="ruby-identifier">migrate</span>(<span class="ruby-string">&quot;valid&quot;</span>, <span class="ruby-keyword">nil</span>)

  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">2</span>], [<span class="ruby-value">:up</span>, <span class="ruby-number">3</span>]], <span class="ruby-identifier">calls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_relative_migrations">
            
              <b>test_relative_migrations</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_relative_migrations" name="method-i-test_relative_migrations" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_relative_migrations_source')" id="l_method-i-test_relative_migrations_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L94" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_relative_migrations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_relative_migrations</span>
  <span class="ruby-identifier">list</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span>(<span class="ruby-constant">MIGRATIONS_ROOT</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">migrations</span>(<span class="ruby-string">&quot;valid/&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">migration_proxy</span> = <span class="ruby-identifier">list</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">item</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;ValidPeopleHaveLastNames&#39;</span>
  }
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">migration_proxy</span>, <span class="ruby-string">&#39;should find pending migration&#39;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_target_version_zero_should_run_only_once">
            
              <b>test_target_version_zero_should_run_only_once</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_target_version_zero_should_run_only_once" name="method-i-test_target_version_zero_should_run_only_once" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_target_version_zero_should_run_only_once_source')" id="l_method-i-test_target_version_zero_should_run_only_once_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L249" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_target_version_zero_should_run_only_once_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_target_version_zero_should_run_only_once</span>
  <span class="ruby-identifier">calls</span>, <span class="ruby-identifier">migrations</span> = <span class="ruby-identifier">sensors</span>(<span class="ruby-number">3</span>)

  <span class="ruby-comment"># migrate up to 1</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">1</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:up</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-comment"># migrate down to 0</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">0</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [[<span class="ruby-value">:down</span>, <span class="ruby-number">1</span>]], <span class="ruby-identifier">calls</span>
  <span class="ruby-identifier">calls</span>.<span class="ruby-identifier">clear</span>

  <span class="ruby-comment"># migrate down to 0 again</span>
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:down</span>, <span class="ruby-identifier">migrations</span>, <span class="ruby-number">0</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert_equal</span> [], <span class="ruby-identifier">calls</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-test_up_calls_up">
            
              <b>test_up_calls_up</b>()
            
            <a href="../../classes/ActiveRecord/MigratorTest.html#method-i-test_up_calls_up" name="method-i-test_up_calls_up" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-test_up_calls_up_source')" id="l_method-i-test_up_calls_up_source">show</a>
                
                  | <a href="https://github.com/rails/rails/blob/07996ebc50f5906dbecc481ac83ed2adefc9ec6e/activerecord/test/cases/migrator_test.rb#L137" target="_blank" class="github_url">on GitHub</a>
                
              </p>
              <div id="method-i-test_up_calls_up_source" class="dyn-source">
                <pre><span class="ruby-comment"># File activerecord/test/cases/migrator_test.rb, line 137</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">test_up_calls_up</span>
  <span class="ruby-identifier">migrations</span> = [<span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-number">0</span>), <span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-number">1</span>), <span class="ruby-constant">Sensor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-number">2</span>)]
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:up</span>, <span class="ruby-identifier">migrations</span>).<span class="ruby-identifier">migrate</span>
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">migrations</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m</span>.<span class="ruby-identifier">went_up</span> }
  <span class="ruby-identifier">assert</span> <span class="ruby-identifier">migrations</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">m</span>.<span class="ruby-identifier">went_down</span> }
  <span class="ruby-identifier">assert_equal</span> <span class="ruby-number">2</span>, <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">current_version</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>

    </div>
  </body>
</html>    